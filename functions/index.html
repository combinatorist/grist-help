<!DOCTYPE html>
<html lang="en">
<head>
  
  
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
      <meta name="description" content="Grist formulas support most Excel functions, as well as the Python programming language.">
      <meta property="og:description" content="Grist formulas support most Excel functions, as well as the Python programming language.">
    
    
    <link rel="canonical" href="https://support.getgrist.com/functions/">
    <link rel="shortcut icon" href="/images/favicon.png">
    <link rel="me" href="https://fosstodon.org/@grist">
    <meta name="thumbnail" content="https://support.getgrist.com/images/favicon.png">
    <meta property="og:image" content="https://support.getgrist.com/images/favicon.png">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" />
    <title>Function reference - Grist Help Center</title>
    
  

  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
  j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
  'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
  })(window,document,'script','dataLayer','GTM-5FDHKQ9');</script>
  <!-- End Google Tag Manager -->
    <link href="/css/bootstrap-3.3.7.min.css" rel="stylesheet">
    <link href="/css/font-awesome-4.7.0.css" rel="stylesheet">
    <link href="/css/base.css" rel="stylesheet">
    <link rel="stylesheet" href="/css/highlight.css">
    <link href="../css/grist.css" rel="stylesheet">
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
        <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->

    <script src="/js/jquery-3.2.1.min.js"></script>
    <script src="/js/bootstrap-3.3.7.min.js"></script>
    <script src="/js/highlight.pack.js"></script>
    <script src="/js/elasticlunr.min.js"></script>
    <script>
      var base_url = '..';
      var is_top_frame = false;
    </script>
    <script src="/js/base.js"></script>
      <script src="../js/grist.js"></script>
    <script type="text/javascript">!function(e,t,n){function a(){var e=t.getElementsByTagName("script")[0],n=t.createElement("script");n.type="text/javascript",n.async=!0,n.src="https://beacon-v2.helpscout.net",e.parentNode.insertBefore(n,e)}if(e.Beacon=n=function(t,n,a){e.Beacon.readyQueue.push({method:t,options:n,data:a})},n.readyQueue=[],"complete"===t.readyState)return a();e.attachEvent?e.attachEvent("onload",a):e.addEventListener("load",a,!1)}(window,document,window.Beacon||function(){});</script>
<script type="text/javascript">
  document.addEventListener("DOMContentLoaded", function() {
    window.Beacon('config', {display: { style: 'icon' }});
    window.Beacon('init', 'fc61df2a-664b-4422-b24f-964bd0cb6d53');
    window.Beacon('suggest', [
      {url: 'https://community.getgrist.com/', text: 'Community Forum'},
      {url: 'https://docs.getgrist.com/p/templates', text: 'Templates'},
      {url: 'https://github.com/gristlabs/grist-core/projects/1', text: 'Roadmap'},
    ]);

    fetch('https://api.getgrist.com/api/session/access/all', {credentials: 'include'})
      .then(function(resp) { return resp.json(); })
      .then(function(status) {
        // If there's exactly two orgs, will use the team name for the non-merged personal
        // org as the company name.  Otherwise don't worry about setting company name.
        var org = undefined;
        if (status.orgs.length === 2) {
          org = status.orgs[0].owner ? status.orgs[1] : status.orgs[0];
        }
        // If there's one user account available, fill it in silently; otherwise use
        // the first one and prefill fields but let user see them so they can override
        // them.  If testing this, be aware that if 'identify' was called previously,
        // it will be cached in local storage and used even if it is not set this time
        // around.
        var user = status.users[0];
        var identifyOrPrefill = status.users.length === 1 ? 'identify' : 'prefill';
        if (user && !user.anonymous) {
          var userObj = {};
          if (user.email) { userObj.email = user.email; }
          if (user.name) { userObj.name = user.name; }
          if (user.picture) { userObj.avatar = user.picture; }
          if (user.helpScoutSignature) { userObj.signature = user.helpScoutSignature; }
          if (org && org.name) { userObj.company = org.name; }
          window.Beacon(identifyOrPrefill, userObj);
        }
      });
  });
</script> 
</head>

<body>
  
  

  <!-- Google Tag Manager (noscript) -->
  <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-5FDHKQ9"
  height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
  <!-- End Google Tag Manager (noscript) -->

<nav class="navbar wm-page-top-frame">
  <div class="container-fluid wm-top-container">
    
    <div class="wm-top-tool pull-right wm-vcenter">
      <form class="dropdown wm-vcentered" id="wm-search-form" action="/search.html" method="GET">
        
        <button id="wm-search-show" class="btn btn-sm btn-default" type="submit"
          ><i class="fa fa-search" aria-hidden="true"></i></button>

        <div class="input-group input-group-sm wm-top-search">
          <input type="text" name="q" class="form-control" id="mkdocs-search-query" placeholder="Search" autocomplete="off">
          <span class="input-group-btn" role="search">
            
            <button class="btn btn-default dropdown-toggle collapse" data-toggle="dropdown" type="button"><span class="caret"></span></button>
            <ul id="mkdocs-search-results" class="dropdown-menu dropdown-menu-right"></ul>
            <button id="wm-search-go" class="btn btn-default" type="submit"><i class="fa fa-search" aria-hidden="true"></i></button>
          </span>
        </div>
      </form>
    </div>

    
    <div class="wm-top-tool wm-vcenter pull-right wm-small-left wm-top-toc-button">
      <button id="wm-toc-button" type="button" class="btn btn-sm btn-default wm-vcentered"><i class="fa fa-th-list" aria-hidden="true"></i></button>
    </div>
    <select id="wm-language-select" class="wm-top-tool wm-vcenter pull-right wm-small-left home-top-tool-selector" name="lang"
      
      >
      
      <option value="/" selected>en - English</option>
      
      <option value="/fr/" >fr - fran√ßais</option>
      
    </select>

    
    

    
    
      <a href="https://community.getgrist.com" class="wm-top-tool wm-top-link pull-right wm-vcenter home-link ">
        <div class="wm-top-title">
          Community
        </div>
      </a>
    
      <a href="https://www.getgrist.com" class="wm-top-tool wm-top-link pull-right wm-vcenter home-link wm-small-hide">
        <div class="wm-top-title">
          Back to Grist
        </div>
      </a>
    

    
    <a href=".." class="wm-top-brand wm-top-link wm-vcenter">
      
        <img class="wm-top-logo" src="../images/logo.png"/>
      
      <div class="wm-top-title">
        Grist Help Center<br>
        
          <span class="wm-top-version">1.0.2-dev</span>
        
      </div>
    </a>
  </div>
</nav>

<div id="main-content">
  
<nav class="wm-toc-pane">
  
  <ul class="wm-toctree">
        <li class="wm-toc-li wm-toc-lev1 "><a href=".." class="wm-article-link wm-toc-text">Welcome to Grist</a>

    
</li>
        <li class="wm-toc-li wm-toc-lev1 "><a href="../FAQ/" class="wm-article-link wm-toc-text">FAQ</a>

    
</li>
        <li class="wm-toc-li wm-toc-lev1 wm-toc-opener"><span class="wm-toc-text">How-to tutorials</span>
</li>
<li class="wm-toc-li-nested collapse">
  <ul class="wm-toctree">
      <li class="wm-toc-li wm-toc-lev2 "><a href="../lightweight-crm/" class="wm-article-link wm-toc-text">Create your own CRM</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../investment-research/" class="wm-article-link wm-toc-text">Analyze and visualize</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../afterschool-program/" class="wm-article-link wm-toc-text">Manage business data</a>

    
</li>
  </ul>
</li>

        <li class="wm-toc-li wm-toc-lev1 wm-toc-opener"><span class="wm-toc-text">Managing documents</span>
</li>
<li class="wm-toc-li-nested collapse">
  <ul class="wm-toctree">
      <li class="wm-toc-li wm-toc-lev2 "><a href="../creating-doc/" class="wm-article-link wm-toc-text">Creating a document</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../sharing/" class="wm-article-link wm-toc-text">Sharing a document</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../copying-docs/" class="wm-article-link wm-toc-text">Copying documents</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../imports/" class="wm-article-link wm-toc-text">Importing more data</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../exports/" class="wm-article-link wm-toc-text">Exports & backups</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../automatic-backups/" class="wm-article-link wm-toc-text">Automatic backups</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../document-history/" class="wm-article-link wm-toc-text">Document history</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../workspaces/" class="wm-article-link wm-toc-text">Workspaces</a>

    
</li>
  </ul>
</li>

        <li class="wm-toc-li wm-toc-lev1 wm-toc-opener"><span class="wm-toc-text">Pages and tables</span>
</li>
<li class="wm-toc-li-nested collapse">
  <ul class="wm-toctree">
      <li class="wm-toc-li wm-toc-lev2 "><a href="../enter-data/" class="wm-article-link wm-toc-text">Entering data</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../page-widgets/" class="wm-article-link wm-toc-text">Pages & widgets</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../raw-data/" class="wm-article-link wm-toc-text">Raw data</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../search-sort-filter/" class="wm-article-link wm-toc-text">Search, sort & filter</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../widget-table/" class="wm-article-link wm-toc-text">Table widget</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../widget-card/" class="wm-article-link wm-toc-text">Card & card list</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../widget-form/" class="wm-article-link wm-toc-text">Form</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../widget-chart/" class="wm-article-link wm-toc-text">Chart</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../widget-calendar/" class="wm-article-link wm-toc-text">Calendar</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../widget-custom/" class="wm-article-link wm-toc-text">Custom</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../linking-widgets/" class="wm-article-link wm-toc-text">Linking widgets</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../custom-layouts/" class="wm-article-link wm-toc-text">Custom layouts</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../record-cards/" class="wm-article-link wm-toc-text">Record cards</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../summary-tables/" class="wm-article-link wm-toc-text">Summary tables</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../on-demand-tables/" class="wm-article-link wm-toc-text">On-demand tables</a>

    
</li>
  </ul>
</li>

        <li class="wm-toc-li wm-toc-lev1 wm-toc-opener"><span class="wm-toc-text">Columns and data types</span>
</li>
<li class="wm-toc-li-nested collapse">
  <ul class="wm-toctree">
      <li class="wm-toc-li wm-toc-lev2 "><a href="../col-types/" class="wm-article-link wm-toc-text">Columns & types</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../col-refs/" class="wm-article-link wm-toc-text">Reference columns</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../conditional-formatting/" class="wm-article-link wm-toc-text">Conditional formatting</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../timestamps/" class="wm-article-link wm-toc-text">Timestamp columns</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../authorship/" class="wm-article-link wm-toc-text">Authorship columns</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../col-transform/" class="wm-article-link wm-toc-text">Transformations</a>

    
</li>
  </ul>
</li>

        <li class="wm-toc-li wm-toc-lev1 wm-toc-opener"><span class="wm-toc-text">Using formulas</span>
</li>
<li class="wm-toc-li-nested collapse">
  <ul class="wm-toctree">
      <li class="wm-toc-li wm-toc-lev2 "><a href="../formulas/" class="wm-article-link wm-toc-text">Intro to formulas</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../references-lookups/" class="wm-article-link wm-toc-text">References and lookups</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../dates/" class="wm-article-link wm-toc-text">Working with dates</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../formula-timer/" class="wm-article-link wm-toc-text">Formula timer</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../python/" class="wm-article-link wm-toc-text">Python versions</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2  wm-current wm-page-toc-opener wm-page-toc-open"><a href="./" class="wm-article-link wm-toc-text">Function reference</a>

    
    
    <li class="wm-page-toc wm-toc-li-nested collapse in">
      <ul class="wm-toctree">
        
          <li class="wm-toc-li">
            <a class="wm-article-link wm-page-toc-text" href="#_top">
              
            </a>
          </li>
            <li class="wm-toc-li">
              <a class="wm-article-link wm-page-toc-text" href="#grist">
                Grist
              </a>
            </li>
            <li class="wm-toc-li">
              <a class="wm-article-link wm-page-toc-text" href="#cumulative">
                Cumulative
              </a>
            </li>
            <li class="wm-toc-li">
              <a class="wm-article-link wm-page-toc-text" href="#date">
                Date
              </a>
            </li>
            <li class="wm-toc-li">
              <a class="wm-article-link wm-page-toc-text" href="#info">
                Info
              </a>
            </li>
            <li class="wm-toc-li">
              <a class="wm-article-link wm-page-toc-text" href="#logical">
                Logical
              </a>
            </li>
            <li class="wm-toc-li">
              <a class="wm-article-link wm-page-toc-text" href="#lookup">
                Lookup
              </a>
            </li>
            <li class="wm-toc-li">
              <a class="wm-article-link wm-page-toc-text" href="#math">
                Math
              </a>
            </li>
            <li class="wm-toc-li">
              <a class="wm-article-link wm-page-toc-text" href="#schedule">
                Schedule
              </a>
            </li>
            <li class="wm-toc-li">
              <a class="wm-article-link wm-page-toc-text" href="#stats">
                Stats
              </a>
            </li>
            <li class="wm-toc-li">
              <a class="wm-article-link wm-page-toc-text" href="#text">
                Text
              </a>
            </li>
        
      </ul>
    </li>
    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../formula-cheat-sheet/" class="wm-article-link wm-toc-text">Formula cheat sheet</a>

    
</li>
  </ul>
</li>

        <li class="wm-toc-li wm-toc-lev1 wm-toc-opener"><span class="wm-toc-text">AI Formula Assistant</span>
</li>
<li class="wm-toc-li-nested collapse">
  <ul class="wm-toctree">
      <li class="wm-toc-li wm-toc-lev2 "><a href="../ai-assistant/" class="wm-article-link wm-toc-text">AI Formula Assistant</a>

    
</li>
  </ul>
</li>

        <li class="wm-toc-li wm-toc-lev1 wm-toc-opener"><span class="wm-toc-text">Team sites</span>
</li>
<li class="wm-toc-li-nested collapse">
  <ul class="wm-toctree">
      <li class="wm-toc-li wm-toc-lev2 "><a href="../teams/" class="wm-article-link wm-toc-text">Creating team sites</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../team-sharing/" class="wm-article-link wm-toc-text">Sharing team sites</a>

    
</li>
  </ul>
</li>

        <li class="wm-toc-li wm-toc-lev1 wm-toc-opener"><span class="wm-toc-text">Access rules</span>
</li>
<li class="wm-toc-li-nested collapse">
  <ul class="wm-toctree">
      <li class="wm-toc-li wm-toc-lev2 "><a href="../access-rules/" class="wm-article-link wm-toc-text">Intro to access rules</a>

    
</li>
  </ul>
</li>

        <li class="wm-toc-li wm-toc-lev1 wm-toc-opener"><span class="wm-toc-text">Integrations</span>
</li>
<li class="wm-toc-li-nested collapse">
  <ul class="wm-toctree">
      <li class="wm-toc-li wm-toc-lev2 "><a href="../rest-api/" class="wm-article-link wm-toc-text">REST API usage</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../api/" class="wm-article-link wm-toc-text">REST API reference</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../integrators/" class="wm-article-link wm-toc-text">Integrator services</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../embedding/" class="wm-article-link wm-toc-text">Embedding</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../webhooks/" class="wm-article-link wm-toc-text">Webhooks</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 wm-toc-opener"><span class="wm-toc-text">Plugin API</span>
</li>
<li class="wm-toc-li-nested collapse">
  <ul class="wm-toctree">
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/" class="wm-article-link wm-toc-text">Intro to Plugin API</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/modules/grist_plugin_api/" class="wm-article-link wm-toc-text">grist-plugin-api</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/DocApiTypes.AddOrUpdateRecord/" class="wm-article-link wm-toc-text">Interface: AddOrUpdateRecord</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/DocApiTypes.MinimalRecord/" class="wm-article-link wm-toc-text">Interface: MinimalRecord</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/DocApiTypes.NewRecord/" class="wm-article-link wm-toc-text">Interface: NewRecord</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/DocApiTypes.Record/" class="wm-article-link wm-toc-text">Interface: Record</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/DocApiTypes.RecordsPatch/" class="wm-article-link wm-toc-text">Interface: RecordsPatch</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/DocApiTypes.RecordsPost/" class="wm-article-link wm-toc-text">Interface: RecordsPost</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/DocApiTypes.RecordsPut/" class="wm-article-link wm-toc-text">Interface: RecordsPut</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/DocApiTypes.SqlPost/" class="wm-article-link wm-toc-text">Interface: SqlPost</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/DocApiTypes.TablePost/" class="wm-article-link wm-toc-text">Interface: TablePost</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/GristData.RowRecord/" class="wm-article-link wm-toc-text">Interface: RowRecord</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/GristData.RowRecords/" class="wm-article-link wm-toc-text">Interface: RowRecords</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/TableOperations.OpOptions/" class="wm-article-link wm-toc-text">Interface: OpOptions</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/TableOperations.TableOperations/" class="wm-article-link wm-toc-text">Interface: TableOperations</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/TableOperations.UpsertOptions/" class="wm-article-link wm-toc-text">Interface: UpsertOptions</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/grist_plugin_api.AccessTokenOptions/" class="wm-article-link wm-toc-text">Interface: AccessTokenOptions</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/grist_plugin_api.AccessTokenResult/" class="wm-article-link wm-toc-text">Interface: AccessTokenResult</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/grist_plugin_api.ColumnToMap/" class="wm-article-link wm-toc-text">Interface: ColumnToMap</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/grist_plugin_api.CursorPos/" class="wm-article-link wm-toc-text">Interface: CursorPos</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/grist_plugin_api.CustomSectionAPI/" class="wm-article-link wm-toc-text">Interface: CustomSectionAPI</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/grist_plugin_api.FetchSelectedOptions/" class="wm-article-link wm-toc-text">Interface: FetchSelectedOptions</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/grist_plugin_api.GristColumn/" class="wm-article-link wm-toc-text">Interface: GristColumn</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/grist_plugin_api.GristDocAPI/" class="wm-article-link wm-toc-text">Interface: GristDocAPI</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/grist_plugin_api.GristTable/" class="wm-article-link wm-toc-text">Interface: GristTable</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/grist_plugin_api.GristView/" class="wm-article-link wm-toc-text">Interface: GristView</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/grist_plugin_api.InteractionOptions/" class="wm-article-link wm-toc-text">Interface: InteractionOptions</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/grist_plugin_api.InteractionOptionsRequest/" class="wm-article-link wm-toc-text">Interface: InteractionOptionsRequest</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/grist_plugin_api.ParseOptionSchema/" class="wm-article-link wm-toc-text">Interface: ParseOptionSchema</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/grist_plugin_api.ParseOptions/" class="wm-article-link wm-toc-text">Interface: ParseOptions</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/grist_plugin_api.ReadyPayload/" class="wm-article-link wm-toc-text">Interface: ReadyPayload</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/grist_plugin_api.RenderOptions/" class="wm-article-link wm-toc-text">Interface: RenderOptions</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/grist_plugin_api.WidgetAPI/" class="wm-article-link wm-toc-text">Interface: WidgetAPI</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/interfaces/grist_plugin_api.WidgetColumnMap/" class="wm-article-link wm-toc-text">Interface: WidgetColumnMap</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/modules/DocApiTypes/" class="wm-article-link wm-toc-text">Module: DocApiTypes</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/modules/GristData/" class="wm-article-link wm-toc-text">Module: GristData</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../code/modules/TableOperations/" class="wm-article-link wm-toc-text">Module: TableOperations</a>

    
</li>
  </ul>
</li>

  </ul>
</li>

        <li class="wm-toc-li wm-toc-lev1 wm-toc-opener"><span class="wm-toc-text">Self-managed</span>
</li>
<li class="wm-toc-li-nested collapse">
  <ul class="wm-toctree">
      <li class="wm-toc-li wm-toc-lev2 "><a href="../self-managed/" class="wm-article-link wm-toc-text">Self-managed Grist</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../install/saml/" class="wm-article-link wm-toc-text">SAML</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../install/oidc/" class="wm-article-link wm-toc-text">OIDC</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../install/forwarded-headers/" class="wm-article-link wm-toc-text">Forwarded headers</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../install/cloud-storage/" class="wm-article-link wm-toc-text">Cloud storage</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../install/grist-connect/" class="wm-article-link wm-toc-text">GristConnect</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../install/aws-marketplace/" class="wm-article-link wm-toc-text">AWS Marketplace</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 wm-toc-opener"><span class="wm-toc-text">Telemetry</span>
</li>
<li class="wm-toc-li-nested collapse">
  <ul class="wm-toctree">
      <li class="wm-toc-li wm-toc-lev3 "><a href="../telemetry/" class="wm-article-link wm-toc-text">Overview of telemetry</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../telemetry-limited/" class="wm-article-link wm-toc-text">Limited telemetry</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev3 "><a href="../telemetry-full/" class="wm-article-link wm-toc-text">Full telemetry</a>

    
</li>
  </ul>
</li>

  </ul>
</li>

        <li class="wm-toc-li wm-toc-lev1 wm-toc-opener"><span class="wm-toc-text">News & updates</span>
</li>
<li class="wm-toc-li-nested collapse">
  <ul class="wm-toctree">
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/" class="wm-article-link wm-toc-text">Newsletters</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2024-07/" class="wm-article-link wm-toc-text">2024/07</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2024-06/" class="wm-article-link wm-toc-text">2024/06</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2024-05/" class="wm-article-link wm-toc-text">2024/05</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2024-04/" class="wm-article-link wm-toc-text">2024/04</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2024-03/" class="wm-article-link wm-toc-text">2024/03</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2024-02/" class="wm-article-link wm-toc-text">2024/02</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2024-01/" class="wm-article-link wm-toc-text">2024/01</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2023-12/" class="wm-article-link wm-toc-text">2023/12</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2023-11/" class="wm-article-link wm-toc-text">2023/11</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2023-10/" class="wm-article-link wm-toc-text">2023/10</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2023-09/" class="wm-article-link wm-toc-text">2023/09</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2023-08/" class="wm-article-link wm-toc-text">2023/08</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2023-07/" class="wm-article-link wm-toc-text">2023/07</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2023-06/" class="wm-article-link wm-toc-text">2023/06</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2023-05/" class="wm-article-link wm-toc-text">2023/05</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2023-04/" class="wm-article-link wm-toc-text">2023/04</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2023-03/" class="wm-article-link wm-toc-text">2023/03</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2023-02/" class="wm-article-link wm-toc-text">2023/02</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2023-01/" class="wm-article-link wm-toc-text">2023/01</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2022-12/" class="wm-article-link wm-toc-text">2022/12</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2022-11/" class="wm-article-link wm-toc-text">2022/11</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2022-10/" class="wm-article-link wm-toc-text">2022/10</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2022-09/" class="wm-article-link wm-toc-text">2022/09</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2022-08/" class="wm-article-link wm-toc-text">2022/08</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2022-07/" class="wm-article-link wm-toc-text">2022/07</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2022-06/" class="wm-article-link wm-toc-text">2022/06</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2022-05/" class="wm-article-link wm-toc-text">2022/05</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2022-04/" class="wm-article-link wm-toc-text">2022/04</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2022-03/" class="wm-article-link wm-toc-text">2022/03</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2022-02/" class="wm-article-link wm-toc-text">2022/02</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2022-01/" class="wm-article-link wm-toc-text">2022/01</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2021-12/" class="wm-article-link wm-toc-text">2021/12</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2021-11/" class="wm-article-link wm-toc-text">2021/11</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2021-10/" class="wm-article-link wm-toc-text">2021/10</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2021-09/" class="wm-article-link wm-toc-text">2021/09</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2021-08/" class="wm-article-link wm-toc-text">2021/08</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2021-07/" class="wm-article-link wm-toc-text">2021/07</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2021-06/" class="wm-article-link wm-toc-text">2021/06</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2021-05/" class="wm-article-link wm-toc-text">2021/05</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2021-04/" class="wm-article-link wm-toc-text">2021/04</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2021-03/" class="wm-article-link wm-toc-text">2021/03</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2021-02/" class="wm-article-link wm-toc-text">2021/02</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2021-01/" class="wm-article-link wm-toc-text">2021/01</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2020-12/" class="wm-article-link wm-toc-text">2020/12</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2020-11/" class="wm-article-link wm-toc-text">2020/11</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2020-10/" class="wm-article-link wm-toc-text">2020/10</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2020-09/" class="wm-article-link wm-toc-text">2020/09</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2020-08/" class="wm-article-link wm-toc-text">2020/08</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2020-07/" class="wm-article-link wm-toc-text">2020/07</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2020-06/" class="wm-article-link wm-toc-text">2020/06</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../newsletters/2020-05/" class="wm-article-link wm-toc-text">2020/05</a>

    
</li>
  </ul>
</li>

        <li class="wm-toc-li wm-toc-lev1 wm-toc-opener"><span class="wm-toc-text">More examples</span>
</li>
<li class="wm-toc-li-nested collapse">
  <ul class="wm-toctree">
      <li class="wm-toc-li wm-toc-lev2 "><a href="../examples/" class="wm-article-link wm-toc-text">More examples</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../examples/2020-06-credit-card/" class="wm-article-link wm-toc-text">Credit card expenses</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../examples/2020-06-book-club/" class="wm-article-link wm-toc-text">Book club links</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../examples/2020-07-email-compose/" class="wm-article-link wm-toc-text">Prefill emails</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../examples/2020-08-invoices/" class="wm-article-link wm-toc-text">Prepare invoices</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../examples/2020-09-payroll/" class="wm-article-link wm-toc-text">Track payroll</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../examples/2020-10-print-labels/" class="wm-article-link wm-toc-text">Print mailing labels</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../examples/2020-11-treasure-hunt/" class="wm-article-link wm-toc-text">Treasure hunt</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../examples/2020-12-map/" class="wm-article-link wm-toc-text">Map</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../examples/2021-01-tasks/" class="wm-article-link wm-toc-text">Task management</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../examples/2021-03-leads/" class="wm-article-link wm-toc-text">Lead list</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../examples/2021-04-link-keys/" class="wm-article-link wm-toc-text">Link keys guide</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../examples/2021-05-reference-columns/" class="wm-article-link wm-toc-text">Reference columns guide</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../examples/2021-06-timesheets/" class="wm-article-link wm-toc-text">Summary tables guide</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../examples/2021-07-auto-stamps/" class="wm-article-link wm-toc-text">Time and user stamps</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../examples/2023-01-acl-memo/" class="wm-article-link wm-toc-text">Restrict duplicate records</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../examples/2023-07-proposals-contracts/" class="wm-article-link wm-toc-text">Proposals & contracts</a>

    
</li>
  </ul>
</li>

        <li class="wm-toc-li wm-toc-lev1 wm-toc-opener"><span class="wm-toc-text">Reference</span>
</li>
<li class="wm-toc-li-nested collapse">
  <ul class="wm-toctree">
      <li class="wm-toc-li wm-toc-lev2 "><a href="../keyboard-shortcuts/" class="wm-article-link wm-toc-text">Keyboard shortcuts</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="/functions/" class="wm-article-link wm-toc-text">Function reference</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../limits/" class="wm-article-link wm-toc-text">Limits</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../data-security/" class="wm-article-link wm-toc-text">Data security</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../browser-support/" class="wm-article-link wm-toc-text">Browser support</a>

    
</li>
      <li class="wm-toc-li wm-toc-lev2 "><a href="../glossary/" class="wm-article-link wm-toc-text">Glossary</a>

    
</li>
  </ul>
</li>

  </ul>

  <div class="wm-toc-quick-links">
    <div class="wm-toc-quick-links-header"><span class="wm-toc-text">Quick Links</span></div>
    <ul class="wm-toctree">
      <li class="wm-toc-li wm-toc-lev2">
        <a href="https://community.getgrist.com/" class="wm-quick-link wm-toc-text">Community</a>
      </li>
      <li class="wm-toc-li wm-toc-lev2">
        <a href="https://docs.getgrist.com/p/templates" class="wm-quick-link wm-toc-text">Templates</a>
      </li>
      <li class="wm-toc-li wm-toc-lev2">
        <a href="https://github.com/gristlabs/grist-core/projects/1" class="wm-quick-link wm-toc-text">Roadmap</a>
      </li>
    </ul>
    <ul class="wm-toctree wm-toc-repo">
      <li class="wm-toc-li wm-toc-lev2">
      <a class="wm-quick-link wm-toc-text" href="https://github.com/gristlabs/grist-help">
        <i class="fa fa-github"></i>

        Edit on GitHub
      </a>
      </li>
    </ul>

  </div>

</nav>

  <script>
    // Immediately expand parent items to show the selected page.
    $('.wm-current')
      .parents('.wm-toc-li-nested').addClass('collapse in')
      .prev('.wm-toc-opener').addClass('wm-toc-open');
  </script>
  <div class="wm-content-pane">
    <div class="wm-article">

<div class="container-fluid wm-page-content">
  <a name="_top"></a>
    

    
    
      
    

  <div class="row wm-article-nav-buttons" role="navigation" aria-label="navigation">
    
    <div class="wm-article-nav pull-right">
      <a href="../formula-cheat-sheet/" class="btn btn-xs btn-default pull-right">
        Next
        <i class="fa fa-chevron-right" aria-hidden="true"></i>
      </a>
      <a href="../formula-cheat-sheet/" class="btn btn-xs btn-link">
        Formula cheat sheet
      </a>
    </div>
    
    <div class="wm-article-nav">
      <a href="../python/" class="btn btn-xs btn-default pull-left">
        <i class="fa fa-chevron-left" aria-hidden="true"></i>
        Previous</a><a href="../python/" class="btn btn-xs btn-link">
        Python versions
      </a>
    </div>
    
  </div>

    

    <h1 id="function-reference">Function Reference<a class="headerlink" href="#function-reference" title="Permanent link">#</a></h1>
<p>Grist formulas support most Excel functions, as well as the Python programming language.</p>
<p>The table below lists Grist-specific functions, and the suite of the included Excel-like functions.
In addition, the entire <a href="https://docs.python.org/3/library/">Python standard library</a> is
available. For more about using formulas in Grist, see <a href="../formulas/">Intro to Formulas</a>.</p>
<p><a href="../python/">Grist uses Python (version 3.11)</a> for formulas. You can use nearly all features of
Python (see <a href="https://docs.python.org/3.11/">Python documentation</a>). Here are some helpful notes:</p>
<ul>
<li>Python is case-sensitive, including for Grist table and column names. Excel-like functions are
  always in uppercase. E.g. <a href="https://docs.python.org/3/tutorial/controlflow.html#if-statements"><strong>if</strong></a>
  is a Python keyword, while <a href="#if"><strong>IF</strong></a> is an Excel-like function.</li>
<li>Compare for equality using <code>==</code>, in place of Excel&rsquo;s single <code>=</code> (which in Python means assignment).
  &ldquo;Not equal&rdquo; uses <code>!=</code> in place of Excel&rsquo;s <code>&lt;&gt;</code>.</li>
<li>You may write multi-line Python in formulas (use <code class="keys"><em>Shift</em> + <em>Enter</em></code> to
  add lines), including statements, variables, imports, etc.</li>
<li>Grist code runs in a secure sandbox, with no access to anything outside your document.</li>
</ul>
<!-- BEGIN mkpydocs table -->
<table>
<thead>
<tr>
<th>Category</th>
<th>Functions</th>
</tr>
</thead>
<tbody>
<tr>
<td>Grist</td>
<td><a  href="#record">Record</a> or <a  href="#record"> rec</a>, <a  href="#_field">$Field</a> or <a  href="#_field"> rec.Field</a>, <a  href="#_group">$group</a> or <a  href="#_group"> rec.group</a>, <a  href="#recordset">RecordSet</a>, <a  href="#find_">find.*</a>, <a  href="#usertable">UserTable</a>, <a  href="#all">all</a>, <a  href="#lookupone">lookupOne</a>, <a  href="#lookuprecords">lookupRecords</a></td>
</tr>
<tr>
<td>Cumulative</td>
<td><a  href="#next">NEXT</a>, <a  href="#previous">PREVIOUS</a>, <a  href="#rank">RANK</a></td>
</tr>
<tr>
<td>Date</td>
<td><a  href="#date">DATE</a>, <a  href="#dateadd">DATEADD</a>, <a  href="#datedif">DATEDIF</a>, <a  href="#datevalue">DATEVALUE</a>, <a  href="#date_to_xl">DATE_TO_XL</a>, <a  href="#day">DAY</a>, <a  href="#days">DAYS</a>, <a  href="#dtime">DTIME</a>, <a  href="#edate">EDATE</a>, <a  href="#eomonth">EOMONTH</a>, <a  href="#hour">HOUR</a>, <a  href="#isoweeknum">ISOWEEKNUM</a>, <a  href="#minute">MINUTE</a>, <a  href="#month">MONTH</a>, <a  href="#moonphase">MOONPHASE</a>, <a  href="#now">NOW</a>, <a  href="#second">SECOND</a>, <a  href="#today">TODAY</a>, <a  href="#weekday">WEEKDAY</a>, <a  href="#weeknum">WEEKNUM</a>, <a  href="#xl_to_date">XL_TO_DATE</a>, <a  href="#year">YEAR</a>, <a  href="#yearfrac">YEARFRAC</a></td>
</tr>
<tr>
<td>Info</td>
<td><a class="unimplemented" href="#cell">CELL</a>, <a class="unimplemented" href="#isblank">ISBLANK</a>, <a  href="#isemail">ISEMAIL</a>, <a  href="#iserr">ISERR</a>, <a  href="#iserror">ISERROR</a>, <a  href="#islogical">ISLOGICAL</a>, <a  href="#isna">ISNA</a>, <a  href="#isnontext">ISNONTEXT</a>, <a  href="#isnumber">ISNUMBER</a>, <a  href="#isref">ISREF</a>, <a  href="#isreflist">ISREFLIST</a>, <a  href="#istext">ISTEXT</a>, <a  href="#isurl">ISURL</a>, <a  href="#n">N</a>, <a  href="#na">NA</a>, <a  href="#peek">PEEK</a>, <a  href="#record_2">RECORD</a>, <a class="unimplemented" href="#request">REQUEST</a>, <a class="unimplemented" href="#type">TYPE</a></td>
</tr>
<tr>
<td>Logical</td>
<td><a  href="#and">AND</a>, <a  href="#false">FALSE</a>, <a  href="#if">IF</a>, <a  href="#iferror">IFERROR</a>, <a  href="#not">NOT</a>, <a  href="#or">OR</a>, <a  href="#true">TRUE</a></td>
</tr>
<tr>
<td>Lookup</td>
<td><a  href="#lookupone_2">lookupOne</a>, <a  href="#lookuprecords_2">lookupRecords</a>, <a class="unimplemented" href="#address">ADDRESS</a>, <a class="unimplemented" href="#choose">CHOOSE</a>, <a class="unimplemented" href="#column">COLUMN</a>, <a class="unimplemented" href="#columns">COLUMNS</a>, <a  href="#contains">CONTAINS</a>, <a class="unimplemented" href="#getpivotdata">GETPIVOTDATA</a>, <a class="unimplemented" href="#hlookup">HLOOKUP</a>, <a class="unimplemented" href="#hyperlink">HYPERLINK</a>, <a class="unimplemented" href="#index">INDEX</a>, <a class="unimplemented" href="#indirect">INDIRECT</a>, <a class="unimplemented" href="#lookup">LOOKUP</a>, <a class="unimplemented" href="#match">MATCH</a>, <a class="unimplemented" href="#offset">OFFSET</a>, <a class="unimplemented" href="#row">ROW</a>, <a class="unimplemented" href="#rows">ROWS</a>, <a  href="#self_hyperlink">SELF_HYPERLINK</a>, <a  href="#vlookup">VLOOKUP</a></td>
</tr>
<tr>
<td>Math</td>
<td><a  href="#abs">ABS</a>, <a  href="#acos">ACOS</a>, <a  href="#acosh">ACOSH</a>, <a  href="#arabic">ARABIC</a>, <a  href="#asin">ASIN</a>, <a  href="#asinh">ASINH</a>, <a  href="#atan">ATAN</a>, <a  href="#atan2">ATAN2</a>, <a  href="#atanh">ATANH</a>, <a  href="#ceiling">CEILING</a>, <a  href="#combin">COMBIN</a>, <a  href="#cos">COS</a>, <a  href="#cosh">COSH</a>, <a  href="#degrees">DEGREES</a>, <a  href="#even">EVEN</a>, <a  href="#exp">EXP</a>, <a  href="#fact">FACT</a>, <a  href="#factdouble">FACTDOUBLE</a>, <a  href="#floor">FLOOR</a>, <a  href="#gcd">GCD</a>, <a  href="#int">INT</a>, <a  href="#lcm">LCM</a>, <a  href="#ln">LN</a>, <a  href="#log">LOG</a>, <a  href="#log10">LOG10</a>, <a  href="#mod">MOD</a>, <a  href="#mround">MROUND</a>, <a  href="#multinomial">MULTINOMIAL</a>, <a  href="#num">NUM</a>, <a  href="#odd">ODD</a>, <a  href="#pi">PI</a>, <a  href="#power">POWER</a>, <a  href="#product">PRODUCT</a>, <a  href="#quotient">QUOTIENT</a>, <a  href="#radians">RADIANS</a>, <a  href="#rand">RAND</a>, <a  href="#randbetween">RANDBETWEEN</a>, <a  href="#roman">ROMAN</a>, <a  href="#round">ROUND</a>, <a  href="#rounddown">ROUNDDOWN</a>, <a  href="#roundup">ROUNDUP</a>, <a  href="#seriessum">SERIESSUM</a>, <a  href="#sign">SIGN</a>, <a  href="#sin">SIN</a>, <a  href="#sinh">SINH</a>, <a  href="#sqrt">SQRT</a>, <a  href="#sqrtpi">SQRTPI</a>, <a class="unimplemented" href="#subtotal">SUBTOTAL</a>, <a  href="#sum">SUM</a>, <a class="unimplemented" href="#sumif">SUMIF</a>, <a class="unimplemented" href="#sumifs">SUMIFS</a>, <a  href="#sumproduct">SUMPRODUCT</a>, <a class="unimplemented" href="#sumsq">SUMSQ</a>, <a  href="#tan">TAN</a>, <a  href="#tanh">TANH</a>, <a  href="#trunc">TRUNC</a>, <a  href="#uuid">UUID</a></td>
</tr>
<tr>
<td>Schedule</td>
<td><a  href="#schedule">SCHEDULE</a></td>
</tr>
<tr>
<td>Stats</td>
<td><a class="unimplemented" href="#avedev">AVEDEV</a>, <a  href="#average">AVERAGE</a>, <a  href="#averagea">AVERAGEA</a>, <a class="unimplemented" href="#averageif">AVERAGEIF</a>, <a class="unimplemented" href="#averageifs">AVERAGEIFS</a>, <a  href="#average_weighted">AVERAGE_WEIGHTED</a>, <a class="unimplemented" href="#binomdist">BINOMDIST</a>, <a class="unimplemented" href="#confidence">CONFIDENCE</a>, <a class="unimplemented" href="#correl">CORREL</a>, <a  href="#count">COUNT</a>, <a  href="#counta">COUNTA</a>, <a class="unimplemented" href="#covar">COVAR</a>, <a class="unimplemented" href="#critbinom">CRITBINOM</a>, <a class="unimplemented" href="#devsq">DEVSQ</a>, <a class="unimplemented" href="#expondist">EXPONDIST</a>, <a class="unimplemented" href="#fdist">FDIST</a>, <a class="unimplemented" href="#fisher">FISHER</a>, <a class="unimplemented" href="#fisherinv">FISHERINV</a>, <a class="unimplemented" href="#forecast">FORECAST</a>, <a class="unimplemented" href="#f_dist">F_DIST</a>, <a class="unimplemented" href="#f_dist_rt">F_DIST_RT</a>, <a class="unimplemented" href="#geomean">GEOMEAN</a>, <a class="unimplemented" href="#harmean">HARMEAN</a>, <a class="unimplemented" href="#hypgeomdist">HYPGEOMDIST</a>, <a class="unimplemented" href="#intercept">INTERCEPT</a>, <a class="unimplemented" href="#kurt">KURT</a>, <a class="unimplemented" href="#large">LARGE</a>, <a class="unimplemented" href="#loginv">LOGINV</a>, <a class="unimplemented" href="#lognormdist">LOGNORMDIST</a>, <a  href="#max">MAX</a>, <a  href="#maxa">MAXA</a>, <a  href="#median">MEDIAN</a>, <a  href="#min">MIN</a>, <a  href="#mina">MINA</a>, <a class="unimplemented" href="#mode">MODE</a>, <a class="unimplemented" href="#negbinomdist">NEGBINOMDIST</a>, <a class="unimplemented" href="#normdist">NORMDIST</a>, <a class="unimplemented" href="#norminv">NORMINV</a>, <a class="unimplemented" href="#normsdist">NORMSDIST</a>, <a class="unimplemented" href="#normsinv">NORMSINV</a>, <a class="unimplemented" href="#pearson">PEARSON</a>, <a class="unimplemented" href="#percentile">PERCENTILE</a>, <a class="unimplemented" href="#percentrank">PERCENTRANK</a>, <a class="unimplemented" href="#percentrank_exc">PERCENTRANK_EXC</a>, <a class="unimplemented" href="#percentrank_inc">PERCENTRANK_INC</a>, <a class="unimplemented" href="#permut">PERMUT</a>, <a class="unimplemented" href="#poisson">POISSON</a>, <a class="unimplemented" href="#prob">PROB</a>, <a class="unimplemented" href="#quartile">QUARTILE</a>, <a class="unimplemented" href="#rank_avg">RANK_AVG</a>, <a class="unimplemented" href="#rank_eq">RANK_EQ</a>, <a class="unimplemented" href="#rsq">RSQ</a>, <a class="unimplemented" href="#skew">SKEW</a>, <a class="unimplemented" href="#slope">SLOPE</a>, <a class="unimplemented" href="#small">SMALL</a>, <a class="unimplemented" href="#standardize">STANDARDIZE</a>, <a  href="#stdev">STDEV</a>, <a  href="#stdeva">STDEVA</a>, <a  href="#stdevp">STDEVP</a>, <a  href="#stdevpa">STDEVPA</a>, <a class="unimplemented" href="#steyx">STEYX</a>, <a class="unimplemented" href="#tdist">TDIST</a>, <a class="unimplemented" href="#tinv">TINV</a>, <a class="unimplemented" href="#trimmean">TRIMMEAN</a>, <a class="unimplemented" href="#ttest">TTEST</a>, <a class="unimplemented" href="#t_inv">T_INV</a>, <a class="unimplemented" href="#t_inv_2t">T_INV_2T</a>, <a class="unimplemented" href="#var">VAR</a>, <a class="unimplemented" href="#vara">VARA</a>, <a class="unimplemented" href="#varp">VARP</a>, <a class="unimplemented" href="#varpa">VARPA</a>, <a class="unimplemented" href="#weibull">WEIBULL</a>, <a class="unimplemented" href="#ztest">ZTEST</a></td>
</tr>
<tr>
<td>Text</td>
<td><a  href="#char">CHAR</a>, <a  href="#clean">CLEAN</a>, <a  href="#code">CODE</a>, <a  href="#concat">CONCAT</a>, <a  href="#concatenate">CONCATENATE</a>, <a  href="#dollar">DOLLAR</a>, <a  href="#exact">EXACT</a>, <a  href="#find">FIND</a>, <a  href="#fixed">FIXED</a>, <a  href="#left">LEFT</a>, <a  href="#len">LEN</a>, <a  href="#lower">LOWER</a>, <a  href="#mid">MID</a>, <a  href="#phone_format">PHONE_FORMAT</a>, <a  href="#proper">PROPER</a>, <a  href="#regexextract">REGEXEXTRACT</a>, <a  href="#regexmatch">REGEXMATCH</a>, <a  href="#regexreplace">REGEXREPLACE</a>, <a  href="#replace">REPLACE</a>, <a  href="#rept">REPT</a>, <a  href="#right">RIGHT</a>, <a  href="#search">SEARCH</a>, <a  href="#substitute">SUBSTITUTE</a>, <a  href="#t">T</a>, <a  href="#tasteme">TASTEME</a>, <a class="unimplemented" href="#text">TEXT</a>, <a  href="#trim">TRIM</a>, <a  href="#upper">UPPER</a>, <a  href="#value">VALUE</a></td>
</tr>
</tbody>
</table>
<!-- END mkpydocs table -->

<!-- BEGIN mkpydocs docs -->
<h3 id="grist">Grist<a class="headerlink" href="#grist" title="Permanent link">#</a></h3>
<details id="record"><summary >
#### Record
<code>class __Record__</code>
<a class="headerlink" href="#record" title="Permanent link">#</a>
</summary>
A Record represents a record of data. It is the primary means of accessing values in formulas. A
Record for a particular table has a property for each data and formula column in the table.

In a formula, `$field` is translated to `rec.field`, where `rec` is the Record for which the
formula is being evaluated.

For example:

<pre><code>def Full_Name(rec, table):
  return rec.First_Name + ' ' + rec.LastName

def Name_Length(rec, table):
  return len(rec.Full_Name)
</code></pre>

</details>
<details id="_field"><summary >
#### $Field
<code>__$__*Field* or __rec__*.Field*</code>
<a class="headerlink" href="#_field" title="Permanent link">#</a>
</summary>
Access the field named "Field" of the current record. E.g. `$First_Name` or `rec.First_Name`.
</details>
<details id="_group"><summary >
#### $group
<code>__$group__</code>
<a class="headerlink" href="#_group" title="Permanent link">#</a>
</summary>
In a [summary table](summary-tables.md), `$group` is a special field
containing the list of Records that are summarized by the current summary line.  E.g. the
formula `len($group)` counts the number of those records being summarized in each row.

See [RecordSet](#recordset) for useful properties offered by the returned object.

Examples:

<pre><code>sum($group.Amount)                        # Sum of the Amount field in the matching records
sum(r.Amount for r in $group)             # Same as sum($group.Amount)
sum(r.Amount for r in $group if r &gt; 0)    # Sum of only the positive amounts
sum(r.Shares * r.Price for r in $group)   # Sum of shares * price products
</code></pre>

</details>
<details id="recordset"><summary >
#### RecordSet
<code>class __RecordSet__</code>
<a class="headerlink" href="#recordset" title="Permanent link">#</a>
</summary>
A RecordSet represents a collection of records, as returned by `Table.lookupRecords()` or
`$group` property in summary views.

A RecordSet allows iterating through the records:

<pre><code>sum(r.Amount for r in Students.lookupRecords(First_Name=&quot;John&quot;, Last_Name=&quot;Doe&quot;))
min(r.DueDate for r in Tasks.lookupRecords(Owner=&quot;Bob&quot;))
</code></pre>


RecordSets also provide a convenient way to access the list of values for a particular field for
all the records, as `record_set.Field`. For example, the examples above are equivalent to:

<pre><code>sum(Students.lookupRecords(First_Name=&quot;John&quot;, Last_Name=&quot;Doe&quot;).Amount)
min(Tasks.lookupRecords(Owner=&quot;Bob&quot;).DueDate)
</code></pre>


You can get the number of records in a RecordSet using `len`, e.g. `len($group)`.
</details>
<details id="find_"><summary >
#### find.*
<code>RecordSet.**find.\***(value)</code>
<a class="headerlink" href="#find_" title="Permanent link">#</a>
</summary>
A set of methods for finding values in sorted sets of records, as returned by
[`lookupRecords`](#lookuprecords). For example:

<pre><code>Transactions.lookupRecords(..., order_by=&quot;Date&quot;).find.lt($Date)
Table.lookupRecords(..., order_by=(&quot;Foo&quot;, &quot;Bar&quot;)).find.le(foo, bar)
</code></pre>


If the `find` attribute is shadowed by a same-named user column, you may use `_find` instead.

The methods available are:

- __`lt`__: (less than) find nearest record with sort values < the given values
- __`le`__: (less than or equal to) find nearest record with sort values <= the given values
- __`gt`__: (greater than) find nearest record with sort values > the given values
- __`ge`__: (greater than or equal to) find nearest record with sort values >= the given values
- __`eq`__: (equal to) find nearest record with sort values == the given values

Example from [our Payroll template](https://templates.getgrist.com/5pHLanQNThxk/Payroll).
Each person has a history of pay rates, in the Rates table. To find a rate applicable on a
certain date, here is how you can do it old-style:

<pre><code class="language-python"># Get all the rates for the Person and Role in this row.
rates = Rates.lookupRecords(Person=$Person, Role=$Role)

# Pick out only those rates whose Rate_Start is on or before this row's Date.
past_rates = [r for r in rates if r.Rate_Start &lt;= $Date]

# Select the latest of past_rates, i.e. maximum by Rate_Start.
rate = max(past_rates, key=lambda r: r.Rate_Start)

# Return the Hourly_Rate from the relevant Rates record.
return rate.Hourly_Rate
</code></pre>


With the new methods, it is much simpler:

<pre><code class="language-python">rates = Rates.lookupRecords(Person=$Person, Role=$Role, order_by=&quot;Rate_Start&quot;)
rate = rates.find.le($Date)
return rate.Hourly_Rate
</code></pre>


Note that this is also much faster when there are many rates for the same Person and Role.
</details>
<details id="usertable"><summary >
#### UserTable
<code>class __UserTable__</code>
<a class="headerlink" href="#usertable" title="Permanent link">#</a>
</summary>
Each data table in the document is represented in the code by an instance of `UserTable` class.
These names are always capitalized. A UserTable provides access to all the records in the table,
as well as methods to look up particular records.

Every table in the document is available to all formulas.
</details>
<details id="all"><summary >
#### all
<code>UserTable.__all__</code>
<a class="headerlink" href="#all" title="Permanent link">#</a>
</summary>
The list of all the records in this table.

For example, this evaluates to the number of records in the table `Students`.

<pre><code>len(Students.all)
</code></pre>


This evaluates to the sum of the `Population` field for every record in the table `Countries`.

<pre><code>sum(r.Population for r in Countries.all)
</code></pre>

</details>
<details id="lookupone"><summary >
#### lookupOne
<code>UserTable.__lookupOne__(Field_In_Lookup_Table=value, ...)</code>
<a class="headerlink" href="#lookupone" title="Permanent link">#</a>
</summary>
Returns a [Record](#record) matching the given field=value arguments. The value may be any
expression,
most commonly a field in the current row (e.g. `$SomeField`) or a constant (e.g. a quoted string
like `"Some Value"`).

For example:

<pre><code>People.lookupOne(First_Name=&quot;Lewis&quot;, Last_Name=&quot;Carroll&quot;)
People.lookupOne(Email=$Work_Email)
</code></pre>


Learn more about [lookupOne](references-lookups.md#lookupone).

If multiple records are found, the first match is returned. You may set the optional `order_by`
parameter to the column ID by which to sort the matches, to determine which of them is
returned as the first one. By default, the record with the lowest row ID is returned.

See [`lookupRecords`](#lookuprecords) for details of all available options and behavior of
`order_by` (and of its legacy alternative, `sort_by`).

For example:

<pre><code>Tasks.lookupOne(Project=$id, order_by=&quot;Priority&quot;)  # Task with the smallest Priority.
Rates.lookupOne(Person=$id, order_by=&quot;-Date&quot;)      # Rate with the latest Date.
</code></pre>

</details>
<details id="lookuprecords"><summary >
#### lookupRecords
<code>UserTable.__lookupRecords__(Field_In_Lookup_Table=value, ...)</code>
<a class="headerlink" href="#lookuprecords" title="Permanent link">#</a>
</summary>
Returns a [RecordSet](#recordset) matching the given field=value arguments. The value may be
any expression,
most commonly a field in the current row (e.g. `$SomeField`) or a constant (e.g. a quoted string
like `"Some Value"`) (examples below).

For example:

<pre><code>People.lookupRecords(Email=$Work_Email)
People.lookupRecords(First_Name=&quot;George&quot;, Last_Name=&quot;Washington&quot;)
</code></pre>


You may set the optional `order_by` parameter to the column ID by which to sort the results.
You can prefix the column ID with "-" to reverse the order. You can also specify multiple
column IDs as a tuple (e.g. `order_by=("Account", "-Date")`).

For example:

<pre><code>Transactions.lookupRecords(Account=$Account, order_by=&quot;Date&quot;)
Transactions.lookupRecords(Account=$Account, order_by=&quot;-Date&quot;)
Transactions.lookupRecords(Active=True, order_by=(&quot;Account&quot;, &quot;-Date&quot;))
</code></pre>


For records with equal `order_by` fields, the results are sorted according to how they appear
in views (which is determined by the special `manualSort` column). You may set `order_by=None`
to match the order of records in unsorted views.

By default, with no `order_by`, records are sorted by row ID, as if with `order_by="id"`.

For backward compatibility, `sort_by` may be used instead of `order_by`, but only allows a
single field, and falls back to row ID (rather than `manualSort`).

See [RecordSet](#recordset) for useful properties offered by the returned object. In
particular, methods like [`.find.le`](#find_) allow searching for nearest values.

See [CONTAINS](#contains) for an example utilizing `UserTable.lookupRecords` to find records
where a field of a list type (such as `Choice List` or `Reference List`) contains the given
value.

Learn more about [lookupRecords](references-lookups.md#lookuprecords).
</details>
<h3 id="cumulative">Cumulative<a class="headerlink" href="#cumulative" title="Permanent link">#</a></h3>
<details id="next"><summary >
#### NEXT
<code>__NEXT__(rec, *, group_by=(), order_by)</code>
<a class="headerlink" href="#next" title="Permanent link">#</a>
</summary>
Finds the next record in the table according to the order specified by `order_by`, and
grouping specified by `group_by`. See [`PREVIOUS`](#previous) for details.
</details>
<details id="previous"><summary >
#### PREVIOUS
<code>__PREVIOUS__(rec, *, group_by=(), order_by)</code>
<a class="headerlink" href="#previous" title="Permanent link">#</a>
</summary>
Finds the previous record in the table according to the order specified by `order_by`, and
grouping specified by `group_by`. Each of these arguments may be a column ID or a tuple of
column IDs, and `order_by` allows column IDs to be prefixed with "-" to reverse sort order.

For example,

<pre><code class="language-python">PREVIOUS(rec, order_by=&quot;Date&quot;)    # The previous record when sorted by increasing Date.
PREVIOUS(rec, order_by=&quot;-Date&quot;)   # The previous record when sorted by decreasing Date.
</code></pre>


You may use `group_by` to search for the previous record within a filtered group. For example,
this finds the previous record with the same Account as `rec`, when records are filtered by the
Account of `rec` and sorted by increasing Date:

<pre><code class="language-python">PREVIOUS(rec, group_by=&quot;Account&quot;, order_by=&quot;Date&quot;)
</code></pre>


When multiple records have the same `order_by` values (e.g. the same Date in the examples above),
the order is determined by the relative position of rows in views. This is done internally by
falling back to the special column `manualSort` and the row ID column `id`.

Use `order_by=None` to find the previous record in an unsorted table (when rows may be
rearranged by dragging them manually). For example:

<pre><code class="language-python">PREVIOUS(rec, order_by=None)      # The previous record in the unsorted list of records.
</code></pre>


You may specify multiple column IDs as a tuple, for both `group_by` and `order_by`. This can be
used to match views sorted by multiple columns. For example:

<pre><code class="language-python">PREVIOUS(rec, group_by=(&quot;Account&quot;, &quot;Year&quot;), order_by=(&quot;Date&quot;, &quot;-Amount&quot;))
</code></pre>

</details>
<details id="rank"><summary >
#### RANK
<code>__RANK__(rec, *, group_by=(), order_by, order='asc')</code>
<a class="headerlink" href="#rank" title="Permanent link">#</a>
</summary>
Returns the rank (or position) of this record in the table according to the order specified by
`order_by`, and grouping specified by `group_by`. See [`PREVIOUS`](#previous) for details of
these parameters.

The `order` parameter may be `"asc"` (which is the default) or `"desc"`.

When `order` is `"asc"` or omitted, the first record in the group in the sorted order would have
the rank of 1. When `order` is `"desc"`, the last record in the sorted order would have the rank
of 1.

If there are multiple groups, there will be multiple records with the same rank. In particular,
each group will have a record with rank 1.

For example, `RANK(rec, group_by="Year", order_by="Score", order="desc")` will return the rank of
the current record (`rec`) among all the records in its table for the same year, ordered by
decreasing score.
</details>
<h3 id="date">Date<a class="headerlink" href="#date" title="Permanent link">#</a></h3>
<details id="date"><summary >
#### DATE
<code>__DATE__(year, month, day)</code>
<a class="headerlink" href="#date" title="Permanent link">#</a>
</summary>
Returns the `datetime.datetime` object that represents a particular date.
The DATE function is most useful in formulas where year, month, and day are formulas, not
constants.

If year is between 0 and 1899 (inclusive), adds 1900 to calculate the year.


<pre><code class="language-python">&gt;&gt;&gt; DATE(108, 1, 2)
datetime.date(2008, 1, 2)
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DATE(2008, 1, 2)
datetime.date(2008, 1, 2)
</code></pre>


If month is greater than 12, rolls into the following year.


<pre><code class="language-python">&gt;&gt;&gt; DATE(2008, 14, 2)
datetime.date(2009, 2, 2)
</code></pre>


If month is less than 1, subtracts that many months plus 1, from the first month in the year.


<pre><code class="language-python">&gt;&gt;&gt; DATE(2008, -3, 2)
datetime.date(2007, 9, 2)
</code></pre>


If day is greater than the number of days in the given month, rolls into the following months.


<pre><code class="language-python">&gt;&gt;&gt; DATE(2008, 1, 35)
datetime.date(2008, 2, 4)
</code></pre>


If day is less than 1, subtracts that many days plus 1, from the first day of the given month.


<pre><code class="language-python">&gt;&gt;&gt; DATE(2008, 1, -15)
datetime.date(2007, 12, 16)
</code></pre>

</details>
<details id="dateadd"><summary >
#### DATEADD
<code>__DATEADD__(start_date, days=0, months=0, years=0, weeks=0)</code>
<a class="headerlink" href="#dateadd" title="Permanent link">#</a>
</summary>
Returns the date a given number of days, months, years, or weeks away from `start_date`. You may
specify arguments in any order if you specify argument names. Use negative values to subtract.

For example, `DATEADD(date, 1)` is the same as `DATEADD(date, days=1)`, ands adds one day to
`date`. `DATEADD(date, years=1, days=-1)` adds one year minus one day.



<pre><code class="language-python">&gt;&gt;&gt; DATEADD(DATE(2011, 1, 15), 1)
datetime.date(2011, 1, 16)
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DATEADD(DATE(2011, 1, 15), months=1, days=-1)
datetime.date(2011, 2, 14)
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DATEADD(DATE(2011, 1, 15), years=-2, months=1, days=3, weeks=2)
datetime.date(2009, 3, 4)
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DATEADD(DATE(1975, 4, 30), years=50, weeks=-5)
datetime.date(2025, 3, 26)
</code></pre>


</details>
<details id="datedif"><summary >
#### DATEDIF
<code>__DATEDIF__(start_date, end_date, unit)</code>
<a class="headerlink" href="#datedif" title="Permanent link">#</a>
</summary>
Calculates the number of days, months, or years between two dates.
Unit indicates the type of information that you want returned:

  - "Y": The number of complete years in the period.
  - "M": The number of complete months in the period.
  - "D": The number of days in the period.
  - "MD": The difference between the days in start_date and end_date. The months and years of the
    dates are ignored.
  - "YM": The difference between the months in start_date and end_date. The days and years of the
    dates are ignored.
  - "YD": The difference between the days of start_date and end_date. The years of the dates are
    ignored.

Two complete years in the period (2)


<pre><code class="language-python">&gt;&gt;&gt; DATEDIF(DATE(2001, 1, 1), DATE(2003, 1, 1), &quot;Y&quot;)
2
</code></pre>


440 days between June 1, 2001, and August 15, 2002 (440)


<pre><code class="language-python">&gt;&gt;&gt; DATEDIF(DATE(2001, 6, 1), DATE(2002, 8, 15), &quot;D&quot;)
440
</code></pre>


75 days between June 1 and August 15, ignoring the years of the dates (75)


<pre><code class="language-python">&gt;&gt;&gt; DATEDIF(DATE(2001, 6, 1), DATE(2012, 8, 15), &quot;YD&quot;)
75
</code></pre>


The difference between 1 and 15, ignoring the months and the years of the dates (14)


<pre><code class="language-python">&gt;&gt;&gt; DATEDIF(DATE(2001, 6, 1), DATE(2002, 8, 15), &quot;MD&quot;)
14
</code></pre>

</details>
<details id="datevalue"><summary >
#### DATEVALUE
<code>__DATEVALUE__(date_string, tz=None)</code>
<a class="headerlink" href="#datevalue" title="Permanent link">#</a>
</summary>
Converts a date that is stored as text to a `datetime` object.



<pre><code class="language-python">&gt;&gt;&gt; DATEVALUE(&quot;1/1/2008&quot;)
datetime.datetime(2008, 1, 1, 0, 0, tzinfo=moment.tzinfo('America/New_York'))
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DATEVALUE(&quot;30-Jan-2008&quot;)
datetime.datetime(2008, 1, 30, 0, 0, tzinfo=moment.tzinfo('America/New_York'))
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DATEVALUE(&quot;2008-12-11&quot;)
datetime.datetime(2008, 12, 11, 0, 0, tzinfo=moment.tzinfo('America/New_York'))
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DATEVALUE(&quot;5-JUL&quot;).replace(year=2000)
datetime.datetime(2000, 7, 5, 0, 0, tzinfo=moment.tzinfo('America/New_York'))
</code></pre>


In case of ambiguity, prefer M/D/Y format.


<pre><code class="language-python">&gt;&gt;&gt; DATEVALUE(&quot;1/2/3&quot;)
datetime.datetime(2003, 1, 2, 0, 0, tzinfo=moment.tzinfo('America/New_York'))
</code></pre>

</details>
<details id="date_to_xl"><summary >
#### DATE_TO_XL
<code>__DATE_TO_XL__(date_value)</code>
<a class="headerlink" href="#date_to_xl" title="Permanent link">#</a>
</summary>
Converts a Python `date` or `datetime` object to the serial number as used by
Excel, with December 30, 1899 as serial number 1.

See XL_TO_DATE for more explanation.



<pre><code class="language-python">&gt;&gt;&gt; DATE_TO_XL(datetime.date(2008, 1, 1))
39448.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DATE_TO_XL(datetime.date(2012, 3, 14))
40982.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DATE_TO_XL(datetime.datetime(2012, 3, 14, 1, 30))
40982.0625
</code></pre>

</details>
<details id="day"><summary >
#### DAY
<code>__DAY__(date)</code>
<a class="headerlink" href="#day" title="Permanent link">#</a>
</summary>
Returns the day of a date, as an integer ranging from 1 to 31. Same as `date.day`.



<pre><code class="language-python">&gt;&gt;&gt; DAY(DATE(2011, 4, 15))
15
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DAY(&quot;5/31/2012&quot;)
31
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DAY(datetime.datetime(1900, 1, 1))
1
</code></pre>


</details>
<details id="days"><summary >
#### DAYS
<code>__DAYS__(end_date, start_date)</code>
<a class="headerlink" href="#days" title="Permanent link">#</a>
</summary>
Returns the number of days between two dates. Same as `(end_date - start_date).days`.



<pre><code class="language-python">&gt;&gt;&gt; DAYS(&quot;3/15/11&quot;,&quot;2/1/11&quot;)
42
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DAYS(DATE(2011, 12, 31), DATE(2011, 1, 1))
364
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DAYS(&quot;2/1/11&quot;, &quot;3/15/11&quot;)
-42
</code></pre>


</details>
<details id="dtime"><summary >
#### DTIME
<code>__DTIME__(value, tz=None)</code>
<a class="headerlink" href="#dtime" title="Permanent link">#</a>
</summary>
Returns the value converted to a python `datetime` object. The value may be a
`string`, `date` (interpreted as midnight on that day), `time` (interpreted as a
time-of-day today), or an existing `datetime`.

The returned `datetime` will have its timezone set to the `tz` argument, or the
document's default timezone when `tz` is omitted or None. If the input is itself a
`datetime` with the timezone set, it is returned unchanged (no changes to its timezone).



<pre><code class="language-python">&gt;&gt;&gt; DTIME(datetime.date(2017, 1, 1))
datetime.datetime(2017, 1, 1, 0, 0, tzinfo=moment.tzinfo('America/New_York'))
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DTIME(datetime.date(2017, 1, 1), 'Europe/Paris')
datetime.datetime(2017, 1, 1, 0, 0, tzinfo=moment.tzinfo('Europe/Paris'))
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DTIME(datetime.datetime(2017, 1, 1))
datetime.datetime(2017, 1, 1, 0, 0, tzinfo=moment.tzinfo('America/New_York'))
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DTIME(datetime.datetime(2017, 1, 1, tzinfo=moment.tzinfo('UTC')))
datetime.datetime(2017, 1, 1, 0, 0, tzinfo=moment.tzinfo('UTC'))
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DTIME(datetime.datetime(2017, 1, 1, tzinfo=moment.tzinfo('UTC')), 'Europe/Paris')
datetime.datetime(2017, 1, 1, 0, 0, tzinfo=moment.tzinfo('UTC'))
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DTIME(&quot;1/1/2008&quot;)
datetime.datetime(2008, 1, 1, 0, 0, tzinfo=moment.tzinfo('America/New_York'))
</code></pre>


</details>
<details id="edate"><summary >
#### EDATE
<code>__EDATE__(start_date, months)</code>
<a class="headerlink" href="#edate" title="Permanent link">#</a>
</summary>
Returns the date that is the given number of months before or after `start_date`. Use
EDATE to calculate maturity dates or due dates that fall on the same day of the month as the
date of issue.



<pre><code class="language-python">&gt;&gt;&gt; EDATE(DATE(2011, 1, 15), 1)
datetime.date(2011, 2, 15)
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; EDATE(DATE(2011, 1, 15), -1)
datetime.date(2010, 12, 15)
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; EDATE(DATE(2011, 1, 15), 2)
datetime.date(2011, 3, 15)
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; EDATE(DATE(2012, 3, 1), 10)
datetime.date(2013, 1, 1)
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; EDATE(DATE(2012, 5, 1), -2)
datetime.date(2012, 3, 1)
</code></pre>


</details>
<details id="eomonth"><summary >
#### EOMONTH
<code>__EOMONTH__(start_date, months)</code>
<a class="headerlink" href="#eomonth" title="Permanent link">#</a>
</summary>
Returns the date for the last day of the month that is the indicated number of months before or
after start_date. Use EOMONTH to calculate maturity dates or due dates that fall on the last day
of the month.



<pre><code class="language-python">&gt;&gt;&gt; EOMONTH(DATE(2011, 1, 1), 1)
datetime.date(2011, 2, 28)
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; EOMONTH(DATE(2011, 1, 15), -3)
datetime.date(2010, 10, 31)
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; EOMONTH(DATE(2012, 3, 1), 10)
datetime.date(2013, 1, 31)
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; EOMONTH(DATE(2012, 5, 1), -2)
datetime.date(2012, 3, 31)
</code></pre>


</details>
<details id="hour"><summary >
#### HOUR
<code>__HOUR__(time)</code>
<a class="headerlink" href="#hour" title="Permanent link">#</a>
</summary>
Same as `time.hour`.



<pre><code class="language-python">&gt;&gt;&gt; HOUR(XL_TO_DATE(0.75))
18
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; HOUR(&quot;7/18/2011 7:45&quot;)
7
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; HOUR(&quot;4/21/2012&quot;)
0
</code></pre>


</details>
<details id="isoweeknum"><summary >
#### ISOWEEKNUM
<code>__ISOWEEKNUM__(date)</code>
<a class="headerlink" href="#isoweeknum" title="Permanent link">#</a>
</summary>
Returns the ISO week number of the year for a given date.



<pre><code class="language-python">&gt;&gt;&gt; ISOWEEKNUM(&quot;3/9/2012&quot;)
10
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; [ISOWEEKNUM(DATE(2000 + y, 1, 1)) for y in [0,1,2,3,4,5,6,7,8]]
[52, 1, 1, 1, 1, 53, 52, 1, 1]
</code></pre>


</details>
<details id="minute"><summary >
#### MINUTE
<code>__MINUTE__(time)</code>
<a class="headerlink" href="#minute" title="Permanent link">#</a>
</summary>
Returns the minutes of `datetime`, as an integer from 0 to 59.
Same as `time.minute`.



<pre><code class="language-python">&gt;&gt;&gt; MINUTE(XL_TO_DATE(0.75))
0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MINUTE(&quot;7/18/2011 7:45&quot;)
45
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MINUTE(&quot;12:59:00 PM&quot;)
59
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MINUTE(datetime.time(12, 58, 59))
58
</code></pre>


</details>
<details id="month"><summary >
#### MONTH
<code>__MONTH__(date)</code>
<a class="headerlink" href="#month" title="Permanent link">#</a>
</summary>
Returns the month of a date represented, as an integer from from 1 (January) to 12 (December).
Same as `date.month`.



<pre><code class="language-python">&gt;&gt;&gt; MONTH(DATE(2011, 4, 15))
4
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MONTH(&quot;5/31/2012&quot;)
5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MONTH(datetime.datetime(1900, 1, 1))
1
</code></pre>


</details>
<details id="moonphase"><summary >
#### MOONPHASE
<code>__MOONPHASE__(date, output='emoji')</code>
<a class="headerlink" href="#moonphase" title="Permanent link">#</a>
</summary>
Returns the phase of the moon on the given date. The output defaults to a moon-phase emoji.

- With `output="days"`, the output is the age of the moon in days (new moon being 0).
- With `output="fraction"`, the output is the fraction of the lunar month since new moon.

The calculation isn't astronomically precise, but good enough for wolves and sailors.

Do NOT! use `output="lunacy"`.



<pre><code class="language-python">&gt;&gt;&gt; MOONPHASE(datetime.date(1900, 1, 1), &quot;days&quot;)
0.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MOONPHASE(datetime.date(1900, 1, 1), &quot;fraction&quot;)
0.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MOONPHASE(datetime.datetime(1900, 1, 1)) == 'üåë'
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MOONPHASE(datetime.date(1900, 1, 15)) == 'üåï'
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MOONPHASE(datetime.date(1900, 1, 30)) == 'üåë'
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; [MOONPHASE(DATEADD(datetime.date(2023, 4, 1), days=4*n)) for n in range(8)] == ['üåî', 'üåï', 'üåñ', 'üåó', 'üåò', 'üåë', 'üåí', 'üåì']
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; [round(MOONPHASE(DATEADD(datetime.date(2023, 4, 1), days=4*n), &quot;days&quot;), 1) for n in range(8)]
[10.4, 14.4, 18.4, 22.4, 26.4, 0.9, 4.9, 8.9]
</code></pre>


</details>
<details id="now"><summary >
#### NOW
<code>__NOW__(tz=None)</code>
<a class="headerlink" href="#now" title="Permanent link">#</a>
</summary>
Returns the `datetime` object for the current time.
</details>
<details id="second"><summary >
#### SECOND
<code>__SECOND__(time)</code>
<a class="headerlink" href="#second" title="Permanent link">#</a>
</summary>
Returns the seconds of `datetime`, as an integer from 0 to 59.
Same as `time.second`.



<pre><code class="language-python">&gt;&gt;&gt; SECOND(XL_TO_DATE(0.75))
0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SECOND(&quot;7/18/2011 7:45:13&quot;)
13
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SECOND(datetime.time(12, 58, 59))
59
</code></pre>


</details>
<details id="today"><summary >
#### TODAY
<code>__TODAY__(tz=None)</code>
<a class="headerlink" href="#today" title="Permanent link">#</a>
</summary>
Returns the `date` object for the current date.
</details>
<details id="weekday"><summary >
#### WEEKDAY
<code>__WEEKDAY__(date, return_type=1)</code>
<a class="headerlink" href="#weekday" title="Permanent link">#</a>
</summary>
Returns the day of the week corresponding to a date. The day is given as an integer, ranging
from 1 (Sunday) to 7 (Saturday), by default.

Return_type determines the type of the returned value.

  - 1 (default) - Returns 1 (Sunday) through 7 (Saturday).
  - 2   - Returns 1 (Monday) through 7 (Sunday).
  - 3   - Returns 0 (Monday) through 6 (Sunday).
  - 11  - Returns 1 (Monday) through 7 (Sunday).
  - 12  - Returns 1 (Tuesday) through 7 (Monday).
  - 13  - Returns 1 (Wednesday) through 7 (Tuesday).
  - 14  - Returns 1 (Thursday) through 7 (Wednesday).
  - 15  - Returns 1 (Friday) through 7 (Thursday).
  - 16  - Returns 1 (Saturday) through 7 (Friday).
  - 17  - Returns 1 (Sunday) through 7 (Saturday).



<pre><code class="language-python">&gt;&gt;&gt; WEEKDAY(DATE(2008, 2, 14))
5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; WEEKDAY(DATE(2012, 3, 1))
5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; WEEKDAY(DATE(2012, 3, 1), 1)
5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; WEEKDAY(DATE(2012, 3, 1), 2)
4
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; WEEKDAY(&quot;3/1/2012&quot;, 3)
3
</code></pre>

</details>
<details id="weeknum"><summary >
#### WEEKNUM
<code>__WEEKNUM__(date, return_type=1)</code>
<a class="headerlink" href="#weeknum" title="Permanent link">#</a>
</summary>
Returns the week number of a specific date. For example, the week containing January 1 is the
first week of the year, and is numbered week 1.

Return_type determines which week is considered the first week of the year.

  - 1 (default) - Week 1 is the first week starting Sunday that contains January 1.
  - 2   - Week 1 is the first week starting Monday that contains January 1.
  - 11  - Week 1 is the first week starting Monday that contains January 1.
  - 12  - Week 1 is the first week starting Tuesday that contains January 1.
  - 13  - Week 1 is the first week starting Wednesday that contains January 1.
  - 14  - Week 1 is the first week starting Thursday that contains January 1.
  - 15  - Week 1 is the first week starting Friday that contains January 1.
  - 16  - Week 1 is the first week starting Saturday that contains January 1.
  - 17  - Week 1 is the first week starting Sunday that contains January 1.
  - 21  - ISO 8601 Approach: Week 1 is the first week starting Monday that contains January 4.
        Equivalently, it is the week that contains the first Thursday of the year.



<pre><code class="language-python">&gt;&gt;&gt; WEEKNUM(DATE(2012, 3, 9))
10
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; WEEKNUM(DATE(2012, 3, 9), 2)
11
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; WEEKNUM('1/1/1900')
1
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; WEEKNUM('2/1/1900')
5
</code></pre>

</details>
<details id="xl_to_date"><summary >
#### XL_TO_DATE
<code>__XL_TO_DATE__(value, tz=None)</code>
<a class="headerlink" href="#xl_to_date" title="Permanent link">#</a>
</summary>
Converts a provided Excel serial number representing a date into a `datetime` object.
Value is interpreted as the number of days since December 30, 1899.

(This corresponds to Google Sheets interpretation. Excel starts with Dec. 31, 1899 but wrongly
considers 1900 to be a leap year. Excel for Mac should be configured to use 1900 date system,
i.e. uncheck "Use the 1904 date system" option.)

The returned `datetime` will have its timezone set to the `tz` argument, or the
document's default timezone when `tz` is omitted or None.



<pre><code class="language-python">&gt;&gt;&gt; XL_TO_DATE(41100.1875)
datetime.datetime(2012, 7, 10, 4, 30, tzinfo=moment.tzinfo('America/New_York'))
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; XL_TO_DATE(39448)
datetime.datetime(2008, 1, 1, 0, 0, tzinfo=moment.tzinfo('America/New_York'))
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; XL_TO_DATE(40982.0625)
datetime.datetime(2012, 3, 14, 1, 30, tzinfo=moment.tzinfo('America/New_York'))
</code></pre>

</details>
<details id="year"><summary >
#### YEAR
<code>__YEAR__(date)</code>
<a class="headerlink" href="#year" title="Permanent link">#</a>
</summary>
Returns the year corresponding to a date as an integer.
Same as `date.year`.



<pre><code class="language-python">&gt;&gt;&gt; YEAR(DATE(2011, 4, 15))
2011
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; YEAR(&quot;5/31/2030&quot;)
2030
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; YEAR(datetime.datetime(1900, 1, 1))
1900
</code></pre>


</details>
<details id="yearfrac"><summary >
#### YEARFRAC
<code>__YEARFRAC__(start_date, end_date, basis=0)</code>
<a class="headerlink" href="#yearfrac" title="Permanent link">#</a>
</summary>
Calculates the fraction of the year represented by the number of whole days between two dates.

Basis is the type of day count basis to use.

  * `0` (default) - US (NASD) 30/360
  * `1`   - Actual/actual
  * `2`   - Actual/360
  * `3`   - Actual/365
  * `4`   - European 30/360
  * `-1`  - Actual/actual (Google Sheets variation)

This function is useful for financial calculations. For compatibility with Excel, it defaults to
using the NASD standard calendar. For use in non-financial settings, option `-1` is
likely the best choice.

See <https://en.wikipedia.org/wiki/360-day_calendar> for explanation of
the US 30/360 and European 30/360 methods. See <http://www.dwheeler.com/yearfrac/> for analysis of
Excel's particular implementation.

Basis `-1` is similar to `1`, but differs from Excel when dates span both leap and non-leap years.
It matches the calculation in Google Sheets, counting the days in each year as a fraction of
that year's length.

Fraction of the year between 1/1/2012 and 7/30/12, omitting the Basis argument.


<pre><code class="language-python">&gt;&gt;&gt; &quot;%.8f&quot; % YEARFRAC(DATE(2012, 1, 1), DATE(2012, 7, 30))
'0.58055556'
</code></pre>


Fraction between same dates, using the Actual/Actual basis argument. Because 2012 is a Leap
year, it has a 366 day basis.


<pre><code class="language-python">&gt;&gt;&gt; &quot;%.8f&quot; % YEARFRAC(DATE(2012, 1, 1), DATE(2012, 7, 30), 1)
'0.57650273'
</code></pre>


Fraction between same dates, using the Actual/365 basis argument. Uses a 365 day basis.


<pre><code class="language-python">&gt;&gt;&gt; &quot;%.8f&quot; % YEARFRAC(DATE(2012, 1, 1), DATE(2012, 7, 30), 3)
'0.57808219'
</code></pre>

</details>
<h3 id="info">Info<a class="headerlink" href="#info" title="Permanent link">#</a></h3>
<details id="cell"><summary class="unimplemented">
#### CELL
<code>__CELL__(info_type, reference)</code>
<a class="headerlink" href="#cell" title="Permanent link">#</a>
</summary>
Returns the requested information about the specified cell. This is not implemented in Grist

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="isblank"><summary class="unimplemented">
#### ISBLANK
<code>__ISBLANK__(value)</code>
<a class="headerlink" href="#isblank" title="Permanent link">#</a>
</summary>
Returns whether a value refers to an empty cell. It isn't implemented in Grist. To check for an
empty string, use `value == ""`.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="isemail"><summary >
#### ISEMAIL
<code>__ISEMAIL__(value)</code>
<a class="headerlink" href="#isemail" title="Permanent link">#</a>
</summary>
Returns whether a value is a valid email address.

Note that checking email validity is not an exact science. The technical standard considers many
email addresses valid that are not used in practice, and would not be considered valid by most
users. Instead, we follow Google Sheets implementation, with some differences, noted below.



<pre><code class="language-python">&gt;&gt;&gt; ISEMAIL(&quot;Abc.123@example.com&quot;)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISEMAIL(&quot;Bob_O-Reilly+tag@example.com&quot;)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISEMAIL(&quot;John Doe&quot;)
False
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISEMAIL(&quot;john@aol...com&quot;)
False
</code></pre>

</details>
<details id="iserr"><summary >
#### ISERR
<code>__ISERR__(value)</code>
<a class="headerlink" href="#iserr" title="Permanent link">#</a>
</summary>
Checks whether a value is an error. In other words, it returns true
if using `value` directly would raise an exception.

NOTE: Grist implements this by automatically wrapping the argument to use lazy evaluation.

A more Pythonic approach to checking for errors is:

<pre><code>try:
  ... value ...
except Exception, err:
  ... do something about the error ...
</code></pre>


For example:



<pre><code class="language-python">&gt;&gt;&gt; ISERR(&quot;Hello&quot;)
False
</code></pre>

</details>
<details id="iserror"><summary >
#### ISERROR
<code>__ISERROR__(value)</code>
<a class="headerlink" href="#iserror" title="Permanent link">#</a>
</summary>
Checks whether a value is an error or an invalid value. It is similar to `ISERR`, but also
returns true for an invalid value such as NaN or a text value in a Numeric column.

NOTE: Grist implements this by automatically wrapping the argument to use lazy evaluation.



<pre><code class="language-python">&gt;&gt;&gt; ISERROR(&quot;Hello&quot;)
False
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISERROR(AltText(&quot;fail&quot;))
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISERROR(float('nan'))
True
</code></pre>

</details>
<details id="islogical"><summary >
#### ISLOGICAL
<code>__ISLOGICAL__(value)</code>
<a class="headerlink" href="#islogical" title="Permanent link">#</a>
</summary>
Checks whether a value is `True` or `False`.



<pre><code class="language-python">&gt;&gt;&gt; ISLOGICAL(True)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISLOGICAL(False)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISLOGICAL(0)
False
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISLOGICAL(None)
False
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISLOGICAL(&quot;Test&quot;)
False
</code></pre>


</details>
<details id="isna"><summary >
#### ISNA
<code>__ISNA__(value)</code>
<a class="headerlink" href="#isna" title="Permanent link">#</a>
</summary>
Checks whether a value is the error `#N/A`.



<pre><code class="language-python">&gt;&gt;&gt; ISNA(float('nan'))
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISNA(0.0)
False
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISNA('text')
False
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISNA(float('-inf'))
False
</code></pre>


</details>
<details id="isnontext"><summary >
#### ISNONTEXT
<code>__ISNONTEXT__(value)</code>
<a class="headerlink" href="#isnontext" title="Permanent link">#</a>
</summary>
Checks whether a value is non-textual.



<pre><code class="language-python">&gt;&gt;&gt; ISNONTEXT(&quot;asdf&quot;)
False
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISNONTEXT(&quot;&quot;)
False
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISNONTEXT(AltText(&quot;text&quot;))
False
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISNONTEXT(17.0)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISNONTEXT(None)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISNONTEXT(datetime.date(2011, 1, 1))
True
</code></pre>


</details>
<details id="isnumber"><summary >
#### ISNUMBER
<code>__ISNUMBER__(value)</code>
<a class="headerlink" href="#isnumber" title="Permanent link">#</a>
</summary>
Checks whether a value is a number.



<pre><code class="language-python">&gt;&gt;&gt; ISNUMBER(17)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISNUMBER(-123.123423)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISNUMBER(False)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISNUMBER(float('nan'))
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISNUMBER(float('inf'))
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISNUMBER('17')
False
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISNUMBER(None)
False
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISNUMBER(datetime.date(2011, 1, 1))
False
</code></pre>

</details>
<details id="isref"><summary >
#### ISREF
<code>__ISREF__(value)</code>
<a class="headerlink" href="#isref" title="Permanent link">#</a>
</summary>
Checks whether a value is a table record.

For example, if a column `person` is of type Reference to the `People` table,
then `ISREF($person)` is `True`.
Similarly, `ISREF(People.lookupOne(name=$name))` is `True`. For any other type of value,
`ISREF()` would evaluate to `False`.



<pre><code class="language-python">&gt;&gt;&gt; ISREF(17)
False
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISREF(&quot;Roger&quot;)
False
</code></pre>


</details>
<details id="isreflist"><summary >
#### ISREFLIST
<code>__ISREFLIST__(value)</code>
<a class="headerlink" href="#isreflist" title="Permanent link">#</a>
</summary>
Checks whether a value is a [`RecordSet`](#recordset),
the type of values in Reference List columns.

For example, if a column `people` is of type Reference List to the `People` table,
then `ISREFLIST($people)` is `True`.
Similarly, `ISREFLIST(People.lookupRecords(name=$name))` is `True`. For any other type of value,
`ISREFLIST()` would evaluate to `False`.



<pre><code class="language-python">&gt;&gt;&gt; ISREFLIST(17)
False
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISREFLIST(&quot;Roger&quot;)
False
</code></pre>


</details>
<details id="istext"><summary >
#### ISTEXT
<code>__ISTEXT__(value)</code>
<a class="headerlink" href="#istext" title="Permanent link">#</a>
</summary>
Checks whether a value is text.



<pre><code class="language-python">&gt;&gt;&gt; ISTEXT(&quot;asdf&quot;)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISTEXT(&quot;&quot;)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISTEXT(AltText(&quot;text&quot;))
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISTEXT(17.0)
False
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISTEXT(None)
False
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISTEXT(datetime.date(2011, 1, 1))
False
</code></pre>


</details>
<details id="isurl"><summary >
#### ISURL
<code>__ISURL__(value)</code>
<a class="headerlink" href="#isurl" title="Permanent link">#</a>
</summary>
Checks whether a value is a valid URL. It does not need to be fully qualified, or to include
"http://" and "www". It does not follow a standard, but attempts to work similarly to ISURL in
Google Sheets, and to return True for text that is likely a URL.

Valid protocols include ftp, http, https, gopher, mailto, news, telnet, and aim.



<pre><code class="language-python">&gt;&gt;&gt; ISURL(&quot;http://www.getgrist.com&quot;)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISURL(&quot;https://foo.com/test_(wikipedia)#cite-1&quot;)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISURL(&quot;mailto://user@example.com&quot;)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ISURL(&quot;http:///a&quot;)
False
</code></pre>

</details>
<details id="n"><summary >
#### N
<code>__N__(value)</code>
<a class="headerlink" href="#n" title="Permanent link">#</a>
</summary>
Returns the value converted to a number. True/False are converted to 1/0. A date is converted to
Excel-style serial number of the date. Anything else is converted to 0.



<pre><code class="language-python">&gt;&gt;&gt; N(7)
7
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; N(7.1)
7.1
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; N(&quot;Even&quot;)
0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; N(&quot;7&quot;)
0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; N(True)
1
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; N(datetime.datetime(2011, 4, 17))
40650.0
</code></pre>


</details>
<details id="na"><summary >
#### NA
<code>__NA__()</code>
<a class="headerlink" href="#na" title="Permanent link">#</a>
</summary>
Returns the "value not available" error, `#N/A`.



<pre><code class="language-python">&gt;&gt;&gt; math.isnan(NA())
True
</code></pre>


</details>
<details id="peek"><summary >
#### PEEK
<code>__PEEK__(func)</code>
<a class="headerlink" href="#peek" title="Permanent link">#</a>
</summary>
Evaluates the given expression without creating dependencies
or requiring that referenced values are up to date, using whatever value it finds in a cell.
This is useful for preventing circular reference errors, particularly in trigger formulas.

For example, if the formula for `A` depends on `$B` and the formula for `B` depends on `$A`,
then normally this would raise a circular reference error because each value needs to be
calculated before the other. But if `A` uses `PEEK($B)` then it will simply get the value
already stored in `$B` without requiring that `$B` is first calculated to the latest value.
Therefore `A` will be calculated first, and `B` can use `$A` without problems.
</details>
<details id="record_2"><summary >
#### RECORD
<code>__RECORD__(record_or_list, dates_as_iso=False, expand_refs=0)</code>
<a class="headerlink" href="#record_2" title="Permanent link">#</a>
</summary>
Returns a Python dictionary with all fields in the given record. If a list of records is given,
returns a list of corresponding Python dictionaries.

If dates_as_iso is set, Date and DateTime values are converted to string using ISO 8601 format.

If expand_refs is set to 1 or higher, Reference values are replaced with a RECORD representation
of the referenced record, expanding the given number of levels.

Error values present in cells of the record are replaced with None value, and a special key of
"_error_" gets added containing the error messages for those cells. For example:
`{"Ratio": None, "_error_": {"Ratio": "ZeroDivisionError: integer division or modulo by zero"}}`

Note that care is needed to avoid circular references when using RECORD(), since it creates a
dependency on every cell in the record. In case of RECORD(rec), the cell containing this call
will be omitted from the resulting dictionary.

For example:

<pre><code>RECORD($Person)
RECORD(rec)
RECORD(People.lookupOne(First_Name=&quot;Alice&quot;))
RECORD(People.lookupRecords(Department=&quot;HR&quot;))
</code></pre>

</details>
<details id="request"><summary class="unimplemented">
#### REQUEST
<code>__REQUEST__(url, params=None, headers=None, method='GET', data=None, json=None)</code>
<a class="headerlink" href="#request" title="Permanent link">#</a>
</summary>

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="type"><summary class="unimplemented">
#### TYPE
<code>__TYPE__(value)</code>
<a class="headerlink" href="#type" title="Permanent link">#</a>
</summary>
Returns a number associated with the type of data passed into the function. This is not
implemented in Grist. Use `isinstance(value, type)` or `type(value)`.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<h3 id="logical">Logical<a class="headerlink" href="#logical" title="Permanent link">#</a></h3>
<details id="and"><summary >
#### AND
<code>__AND__(logical_expression, *logical_expressions)</code>
<a class="headerlink" href="#and" title="Permanent link">#</a>
</summary>
Returns True if all of the arguments are logically true, and False if any are false.
Same as `all([value1, value2, ...])`.



<pre><code class="language-python">&gt;&gt;&gt; AND(1)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; AND(0)
False
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; AND(1, 1)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; AND(1,2,3,4)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; AND(1,2,3,4,0)
False
</code></pre>


</details>
<details id="false"><summary >
#### FALSE
<code>__FALSE__()</code>
<a class="headerlink" href="#false" title="Permanent link">#</a>
</summary>
Returns the logical value `False`. You may also use the value `False` directly. This
function is provided primarily for compatibility with other spreadsheet programs.



<pre><code class="language-python">&gt;&gt;&gt; FALSE()
False
</code></pre>


</details>
<details id="if"><summary >
#### IF
<code>__IF__(logical_expression, value_if_true, value_if_false)</code>
<a class="headerlink" href="#if" title="Permanent link">#</a>
</summary>
Returns one value if a logical expression is `True` and another if it is `False`.

The equivalent Python expression is:

<pre><code>value_if_true if logical_expression else value_if_false
</code></pre>


Since Grist supports multi-line formulas, you may also use Python blocks such as:

<pre><code>if logical_expression:
  return value_if_true
else:
  return value_if_false
</code></pre>


NOTE: Grist follows Excel model by only evaluating one of the value expressions, by
automatically wrapping the expressions to use lazy evaluation. This allows `IF(False, 1/0, 1)`
to evaluate to `1` rather than raise an exception.



<pre><code class="language-python">&gt;&gt;&gt; IF(12, &quot;Yes&quot;, &quot;No&quot;)
'Yes'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; IF(None, &quot;Yes&quot;, &quot;No&quot;)
'No'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; IF(True, 0.85, 0.0)
0.85
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; IF(False, 0.85, 0.0)
0.0
</code></pre>

</details>
<details id="iferror"><summary >
#### IFERROR
<code>__IFERROR__(value, value_if_error='')</code>
<a class="headerlink" href="#iferror" title="Permanent link">#</a>
</summary>
Returns the first argument if it is not an error value, otherwise returns the second argument if
present, or a blank if the second argument is absent.

NOTE: Grist handles values that raise an exception by wrapping them to use lazy evaluation.



<pre><code class="language-python">&gt;&gt;&gt; IFERROR(float('nan'), &quot;**NAN**&quot;)
'**NAN**'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; IFERROR(17.17, &quot;**NAN**&quot;)
17.17
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; IFERROR(&quot;Text&quot;)
'Text'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; IFERROR(AltText(&quot;hello&quot;))
''
</code></pre>

</details>
<details id="not"><summary >
#### NOT
<code>__NOT__(logical_expression)</code>
<a class="headerlink" href="#not" title="Permanent link">#</a>
</summary>
`True`. Same as `not logical_expression`.



<pre><code class="language-python">&gt;&gt;&gt; NOT(123)
False
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; NOT(0)
True
</code></pre>


</details>
<details id="or"><summary >
#### OR
<code>__OR__(logical_expression, *logical_expressions)</code>
<a class="headerlink" href="#or" title="Permanent link">#</a>
</summary>
Returns True if any of the arguments is logically true, and false if all of the
arguments are false.
Same as `any([value1, value2, ...])`.



<pre><code class="language-python">&gt;&gt;&gt; OR(1)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; OR(0)
False
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; OR(1, 1)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; OR(0, 1)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; OR(0, 0)
False
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; OR(0,False,0.0,&quot;&quot;,None)
False
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; OR(0,None,3,0)
True
</code></pre>


</details>
<details id="true"><summary >
#### TRUE
<code>__TRUE__()</code>
<a class="headerlink" href="#true" title="Permanent link">#</a>
</summary>
Returns the logical value `True`. You may also use the value `True` directly. This
function is provided primarily for compatibility with other spreadsheet programs.



<pre><code class="language-python">&gt;&gt;&gt; TRUE()
True
</code></pre>


</details>
<h3 id="lookup">Lookup<a class="headerlink" href="#lookup" title="Permanent link">#</a></h3>
<details id="lookupone_2"><summary >
#### lookupOne
<code>UserTable.__lookupOne__(Field_In_Lookup_Table=value, ...)</code>
<a class="headerlink" href="#lookupone_2" title="Permanent link">#</a>
</summary>
Returns a [Record](#record) matching the given field=value arguments. The value may be any
expression,
most commonly a field in the current row (e.g. `$SomeField`) or a constant (e.g. a quoted string
like `"Some Value"`).

For example:

<pre><code>People.lookupOne(First_Name=&quot;Lewis&quot;, Last_Name=&quot;Carroll&quot;)
People.lookupOne(Email=$Work_Email)
</code></pre>


Learn more about [lookupOne](references-lookups.md#lookupone).

If multiple records are found, the first match is returned. You may set the optional `order_by`
parameter to the column ID by which to sort the matches, to determine which of them is
returned as the first one. By default, the record with the lowest row ID is returned.

See [`lookupRecords`](#lookuprecords) for details of all available options and behavior of
`order_by` (and of its legacy alternative, `sort_by`).

For example:

<pre><code>Tasks.lookupOne(Project=$id, order_by=&quot;Priority&quot;)  # Task with the smallest Priority.
Rates.lookupOne(Person=$id, order_by=&quot;-Date&quot;)      # Rate with the latest Date.
</code></pre>

</details>
<details id="lookuprecords_2"><summary >
#### lookupRecords
<code>UserTable.__lookupRecords__(Field_In_Lookup_Table=value, ...)</code>
<a class="headerlink" href="#lookuprecords_2" title="Permanent link">#</a>
</summary>
Returns a [RecordSet](#recordset) matching the given field=value arguments. The value may be
any expression,
most commonly a field in the current row (e.g. `$SomeField`) or a constant (e.g. a quoted string
like `"Some Value"`) (examples below).

For example:

<pre><code>People.lookupRecords(Email=$Work_Email)
People.lookupRecords(First_Name=&quot;George&quot;, Last_Name=&quot;Washington&quot;)
</code></pre>


You may set the optional `order_by` parameter to the column ID by which to sort the results.
You can prefix the column ID with "-" to reverse the order. You can also specify multiple
column IDs as a tuple (e.g. `order_by=("Account", "-Date")`).

For example:

<pre><code>Transactions.lookupRecords(Account=$Account, order_by=&quot;Date&quot;)
Transactions.lookupRecords(Account=$Account, order_by=&quot;-Date&quot;)
Transactions.lookupRecords(Active=True, order_by=(&quot;Account&quot;, &quot;-Date&quot;))
</code></pre>


For records with equal `order_by` fields, the results are sorted according to how they appear
in views (which is determined by the special `manualSort` column). You may set `order_by=None`
to match the order of records in unsorted views.

By default, with no `order_by`, records are sorted by row ID, as if with `order_by="id"`.

For backward compatibility, `sort_by` may be used instead of `order_by`, but only allows a
single field, and falls back to row ID (rather than `manualSort`).

See [RecordSet](#recordset) for useful properties offered by the returned object. In
particular, methods like [`.find.le`](#find_) allow searching for nearest values.

See [CONTAINS](#contains) for an example utilizing `UserTable.lookupRecords` to find records
where a field of a list type (such as `Choice List` or `Reference List`) contains the given
value.

Learn more about [lookupRecords](references-lookups.md#lookuprecords).
</details>
<details id="address"><summary class="unimplemented">
#### ADDRESS
<code>__ADDRESS__(row, column, absolute_relative_mode, use_a1_notation, sheet)</code>
<a class="headerlink" href="#address" title="Permanent link">#</a>
</summary>
Returns a cell reference as a string.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="choose"><summary class="unimplemented">
#### CHOOSE
<code>__CHOOSE__(index, choice1, choice2)</code>
<a class="headerlink" href="#choose" title="Permanent link">#</a>
</summary>
Returns an element from a list of choices based on index.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="column"><summary class="unimplemented">
#### COLUMN
<code>__COLUMN__(cell_reference=None)</code>
<a class="headerlink" href="#column" title="Permanent link">#</a>
</summary>
Returns the column number of a specified cell, with `A=1`.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="columns"><summary class="unimplemented">
#### COLUMNS
<code>__COLUMNS__(range)</code>
<a class="headerlink" href="#columns" title="Permanent link">#</a>
</summary>
Returns the number of columns in a specified array or range.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="contains"><summary >
#### CONTAINS
<code>__CONTAINS__(value, match_empty=no_match_empty)</code>
<a class="headerlink" href="#contains" title="Permanent link">#</a>
</summary>
Use this marker with [UserTable.lookupRecords](#lookuprecords) to find records
where a field of a list type (such as `Choice List` or `Reference List`) contains the given value.

For example:

    MoviesTable.lookupRecords(genre=CONTAINS("Drama"))

will return records in `MoviesTable` where the column `genre`
is a list or other container such as `["Comedy", "Drama"]`,
i.e. `"Drama" in $genre`.

Note that the column being looked up (e.g. `genre`)
must have values of a container type such as list, tuple, or set.
In particular the values mustn't be strings, e.g. `"Comedy-Drama"` won't match
even though `"Drama" in "Comedy-Drama"` is `True` in Python.
It also won't match substrings within container elements, e.g. `["Comedy-Drama"]`.

You can optionally pass a second argument `match_empty` to indicate a value that
should be matched against empty lists in the looked up column.

For example, given this formula:

    MoviesTable.lookupRecords(genre=CONTAINS(g, match_empty=''))

If `g` is `''` (i.e. equal to `match_empty`) then the column `genre` in the returned records
will either be an empty list (or other container) or a list containing `g` as usual.
</details>
<details id="getpivotdata"><summary class="unimplemented">
#### GETPIVOTDATA
<code>__GETPIVOTDATA__(value_name, any_pivot_table_cell, original_column_1, pivot_item_1=None, *args)</code>
<a class="headerlink" href="#getpivotdata" title="Permanent link">#</a>
</summary>
Extracts an aggregated value from a pivot table that corresponds to the specified row and column headings.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="hlookup"><summary class="unimplemented">
#### HLOOKUP
<code>__HLOOKUP__(search_key, range, index, is_sorted)</code>
<a class="headerlink" href="#hlookup" title="Permanent link">#</a>
</summary>
Horizontal lookup. Searches across the first row of a range for a key and returns the value of a specified cell in the column found.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="hyperlink"><summary class="unimplemented">
#### HYPERLINK
<code>__HYPERLINK__(url, link_label)</code>
<a class="headerlink" href="#hyperlink" title="Permanent link">#</a>
</summary>
Creates a hyperlink inside a cell.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="index"><summary class="unimplemented">
#### INDEX
<code>__INDEX__(reference, row, column)</code>
<a class="headerlink" href="#index" title="Permanent link">#</a>
</summary>
Returns the content of a cell, specified by row and column offset.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="indirect"><summary class="unimplemented">
#### INDIRECT
<code>__INDIRECT__(cell_reference_as_string)</code>
<a class="headerlink" href="#indirect" title="Permanent link">#</a>
</summary>
Returns a cell reference specified by a string.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="lookup"><summary class="unimplemented">
#### LOOKUP
<code>__LOOKUP__(search_key, search_range_or_search_result_array, result_range=None)</code>
<a class="headerlink" href="#lookup" title="Permanent link">#</a>
</summary>
Looks through a row or column for a key and returns the value of the cell in a result range located in the same position as the search row or column.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="match"><summary class="unimplemented">
#### MATCH
<code>__MATCH__(search_key, range, search_type)</code>
<a class="headerlink" href="#match" title="Permanent link">#</a>
</summary>
Returns the relative position of an item in a range that matches a specified value.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="offset"><summary class="unimplemented">
#### OFFSET
<code>__OFFSET__(cell_reference, offset_rows, offset_columns, height, width)</code>
<a class="headerlink" href="#offset" title="Permanent link">#</a>
</summary>
Returns a range reference shifted a specified number of rows and columns from a starting cell reference.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="row"><summary class="unimplemented">
#### ROW
<code>__ROW__(cell_reference)</code>
<a class="headerlink" href="#row" title="Permanent link">#</a>
</summary>
Returns the row number of a specified cell.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="rows"><summary class="unimplemented">
#### ROWS
<code>__ROWS__(range)</code>
<a class="headerlink" href="#rows" title="Permanent link">#</a>
</summary>
Returns the number of rows in a specified array or range.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="self_hyperlink"><summary >
#### SELF_HYPERLINK
<code>__SELF_HYPERLINK__(label=None, page=None, **kwargs)</code>
<a class="headerlink" href="#self_hyperlink" title="Permanent link">#</a>
</summary>
Creates a link to the current document.  All parameters are optional.

The returned string is in URL format, optionally preceded by a label and a space
(the format expected for Grist Text columns with the HyperLink option enabled).

A numeric page number can be supplied, which will create a link to the
specified page.  To find the numeric page number you need, visit a page
and examine its URL for a `/p/NN` part.

Any number of arguments of the form `LinkKey_NAME` may be provided, to set
`user.LinkKey.NAME` values that will be available in access rules.  For example,
if a rule allows users to view rows when `user.LinkKey.Code == rec.Code`,
we might want to create links with `SELF_HYPERLINK(LinkKey_Code=$Code)`.



<pre><code class="language-python">&gt;&gt;&gt; SELF_HYPERLINK()
u'https://docs.getgrist.com/sbaltsirg/Example'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SELF_HYPERLINK(label='doc')
u'doc https://docs.getgrist.com/sbaltsirg/Example'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SELF_HYPERLINK(page=2)
u'https://docs.getgrist.com/sbaltsirg/Example/p/2'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SELF_HYPERLINK(LinkKey_Code='X1234')
u'https://docs.getgrist.com/sbaltsirg/Example?Code_=X1234'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SELF_HYPERLINK(label='order', page=3, LinkKey_Code='X1234', LinkKey_Name='Bi Ngo')
u'order https://docs.getgrist.com/sbaltsirg/Example/p/3?Code_=X1234&amp;Name_=Bi+Ngo'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SELF_HYPERLINK(Linky_Link='Link')
Traceback (most recent call last):
...
TypeError: unexpected keyword argument 'Linky_Link' (not of form LinkKey_NAME)
</code></pre>


</details>
<details id="vlookup"><summary >
#### VLOOKUP
<code>__VLOOKUP__(table, **field_value_pairs)</code>
<a class="headerlink" href="#vlookup" title="Permanent link">#</a>
</summary>
Vertical lookup. Searches the given table for a record matching the given `field=value`
arguments. If multiple records match, returns one of them. If none match, returns the special
empty record.

The returned object is a record whose fields are available using `.field` syntax. For example,
`VLOOKUP(Employees, EmployeeID=$EmpID).Salary`.

Note that `VLOOKUP` isn't commonly needed in Grist, since [Reference columns](col-refs.md) are the
best way to link data between tables, and allow simple efficient usage such as `$Person.Age`.

`VLOOKUP` is exactly quivalent to `table.lookupOne(**field_value_pairs)`. See
[lookupOne](#lookupone).

For example:

<pre><code>VLOOKUP(People, First_Name=&quot;Lewis&quot;, Last_Name=&quot;Carroll&quot;)
VLOOKUP(People, First_Name=&quot;Lewis&quot;, Last_Name=&quot;Carroll&quot;).Age
</code></pre>

</details>
<h3 id="math">Math<a class="headerlink" href="#math" title="Permanent link">#</a></h3>
<details id="abs"><summary >
#### ABS
<code>__ABS__(value)</code>
<a class="headerlink" href="#abs" title="Permanent link">#</a>
</summary>
Returns the absolute value of a number.



<pre><code class="language-python">&gt;&gt;&gt; ABS(2)
2
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ABS(-2)
2
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ABS(-4)
4
</code></pre>


</details>
<details id="acos"><summary >
#### ACOS
<code>__ACOS__(value)</code>
<a class="headerlink" href="#acos" title="Permanent link">#</a>
</summary>
Returns the inverse cosine of a value, in radians.



<pre><code class="language-python">&gt;&gt;&gt; round(ACOS(-0.5), 9)
2.094395102
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(ACOS(-0.5)*180/PI(), 10)
120.0
</code></pre>


</details>
<details id="acosh"><summary >
#### ACOSH
<code>__ACOSH__(value)</code>
<a class="headerlink" href="#acosh" title="Permanent link">#</a>
</summary>
Returns the inverse hyperbolic cosine of a number.



<pre><code class="language-python">&gt;&gt;&gt; ACOSH(1)
0.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(ACOSH(10), 7)
2.9932228
</code></pre>


</details>
<details id="arabic"><summary >
#### ARABIC
<code>__ARABIC__(roman_numeral)</code>
<a class="headerlink" href="#arabic" title="Permanent link">#</a>
</summary>
Computes the value of a Roman numeral.



<pre><code class="language-python">&gt;&gt;&gt; ARABIC(&quot;LVII&quot;)
57
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ARABIC('mcmxii')
1912
</code></pre>


</details>
<details id="asin"><summary >
#### ASIN
<code>__ASIN__(value)</code>
<a class="headerlink" href="#asin" title="Permanent link">#</a>
</summary>
Returns the inverse sine of a value, in radians.



<pre><code class="language-python">&gt;&gt;&gt; round(ASIN(-0.5), 9)
-0.523598776
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(ASIN(-0.5)*180/PI(), 10)
-30.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(DEGREES(ASIN(-0.5)), 10)
-30.0
</code></pre>


</details>
<details id="asinh"><summary >
#### ASINH
<code>__ASINH__(value)</code>
<a class="headerlink" href="#asinh" title="Permanent link">#</a>
</summary>
Returns the inverse hyperbolic sine of a number.



<pre><code class="language-python">&gt;&gt;&gt; round(ASINH(-2.5), 9)
-1.647231146
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(ASINH(10), 9)
2.99822295
</code></pre>


</details>
<details id="atan"><summary >
#### ATAN
<code>__ATAN__(value)</code>
<a class="headerlink" href="#atan" title="Permanent link">#</a>
</summary>
Returns the inverse tangent of a value, in radians.



<pre><code class="language-python">&gt;&gt;&gt; round(ATAN(1), 9)
0.785398163
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ATAN(1)*180/PI()
45.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DEGREES(ATAN(1))
45.0
</code></pre>


</details>
<details id="atan2"><summary >
#### ATAN2
<code>__ATAN2__(x, y)</code>
<a class="headerlink" href="#atan2" title="Permanent link">#</a>
</summary>
Returns the angle between the x-axis and a line segment from the origin (0,0) to specified
coordinate pair (`x`,`y`), in radians.



<pre><code class="language-python">&gt;&gt;&gt; round(ATAN2(1, 1), 9)
0.785398163
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(ATAN2(-1, -1), 9)
-2.35619449
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ATAN2(-1, -1)*180/PI()
-135.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DEGREES(ATAN2(-1, -1))
-135.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(ATAN2(1,2), 9)
1.107148718
</code></pre>


</details>
<details id="atanh"><summary >
#### ATANH
<code>__ATANH__(value)</code>
<a class="headerlink" href="#atanh" title="Permanent link">#</a>
</summary>
Returns the inverse hyperbolic tangent of a number.



<pre><code class="language-python">&gt;&gt;&gt; round(ATANH(0.76159416), 9)
1.00000001
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(ATANH(-0.1), 9)
-0.100335348
</code></pre>


</details>
<details id="ceiling"><summary >
#### CEILING
<code>__CEILING__(value, factor=1)</code>
<a class="headerlink" href="#ceiling" title="Permanent link">#</a>
</summary>
Rounds a number up to the nearest multiple of factor, or the nearest integer if the factor is
omitted or 1.



<pre><code class="language-python">&gt;&gt;&gt; CEILING(2.5, 1)
3
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; CEILING(-2.5, -2)
-4
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; CEILING(-2.5, 2)
-2
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; CEILING(1.5, 0.1)
1.5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; CEILING(0.234, 0.01)
0.24
</code></pre>


</details>
<details id="combin"><summary >
#### COMBIN
<code>__COMBIN__(n, k)</code>
<a class="headerlink" href="#combin" title="Permanent link">#</a>
</summary>
Returns the number of ways to choose some number of objects from a pool of a given size of
objects.



<pre><code class="language-python">&gt;&gt;&gt; COMBIN(8,2)
28
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; COMBIN(4,2)
6
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; COMBIN(10,7)
120
</code></pre>


</details>
<details id="cos"><summary >
#### COS
<code>__COS__(angle)</code>
<a class="headerlink" href="#cos" title="Permanent link">#</a>
</summary>
Returns the cosine of an angle provided in radians.



<pre><code class="language-python">&gt;&gt;&gt; round(COS(1.047), 7)
0.5001711
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(COS(60*PI()/180), 10)
0.5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(COS(RADIANS(60)), 10)
0.5
</code></pre>


</details>
<details id="cosh"><summary >
#### COSH
<code>__COSH__(value)</code>
<a class="headerlink" href="#cosh" title="Permanent link">#</a>
</summary>
Returns the hyperbolic cosine of any real number.



<pre><code class="language-python">&gt;&gt;&gt; round(COSH(4), 6)
27.308233
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(COSH(EXP(1)), 7)
7.6101251
</code></pre>


</details>
<details id="degrees"><summary >
#### DEGREES
<code>__DEGREES__(angle)</code>
<a class="headerlink" href="#degrees" title="Permanent link">#</a>
</summary>
Converts an angle value in radians to degrees.



<pre><code class="language-python">&gt;&gt;&gt; round(DEGREES(ACOS(-0.5)), 10)
120.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DEGREES(PI())
180.0
</code></pre>


</details>
<details id="even"><summary >
#### EVEN
<code>__EVEN__(value)</code>
<a class="headerlink" href="#even" title="Permanent link">#</a>
</summary>
Rounds a number up to the nearest even integer, rounding away from zero.



<pre><code class="language-python">&gt;&gt;&gt; EVEN(1.5)
2
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; EVEN(3)
4
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; EVEN(2)
2
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; EVEN(-1)
-2
</code></pre>


</details>
<details id="exp"><summary >
#### EXP
<code>__EXP__(exponent)</code>
<a class="headerlink" href="#exp" title="Permanent link">#</a>
</summary>
Returns Euler's number, e (~2.718) raised to a power.



<pre><code class="language-python">&gt;&gt;&gt; round(EXP(1), 8)
2.71828183
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(EXP(2), 7)
7.3890561
</code></pre>


</details>
<details id="fact"><summary >
#### FACT
<code>__FACT__(value)</code>
<a class="headerlink" href="#fact" title="Permanent link">#</a>
</summary>
Returns the factorial of a number.



<pre><code class="language-python">&gt;&gt;&gt; FACT(5)
120
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FACT(1.9)
1
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FACT(0)
1
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FACT(1)
1
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FACT(-1)
Traceback (most recent call last):
  ...
ValueError: factorial() not defined for negative values
</code></pre>


</details>
<details id="factdouble"><summary >
#### FACTDOUBLE
<code>__FACTDOUBLE__(value)</code>
<a class="headerlink" href="#factdouble" title="Permanent link">#</a>
</summary>
Returns the "double factorial" of a number.



<pre><code class="language-python">&gt;&gt;&gt; FACTDOUBLE(6)
48
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FACTDOUBLE(7)
105
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FACTDOUBLE(3)
3
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FACTDOUBLE(4)
8
</code></pre>


</details>
<details id="floor"><summary >
#### FLOOR
<code>__FLOOR__(value, factor=1)</code>
<a class="headerlink" href="#floor" title="Permanent link">#</a>
</summary>
Rounds a number down to the nearest integer multiple of specified significance.



<pre><code class="language-python">&gt;&gt;&gt; FLOOR(3.7,2)
2
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FLOOR(-2.5,-2)
-2
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FLOOR(2.5,-2)
Traceback (most recent call last):
  ...
ValueError: factor argument invalid
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FLOOR(1.58,0.1)
1.5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FLOOR(0.234,0.01)
0.23
</code></pre>


</details>
<details id="gcd"><summary >
#### GCD
<code>__GCD__(value1, *more_values)</code>
<a class="headerlink" href="#gcd" title="Permanent link">#</a>
</summary>
Returns the greatest common divisor of one or more integers.



<pre><code class="language-python">&gt;&gt;&gt; GCD(5, 2)
1
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; GCD(24, 36)
12
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; GCD(7, 1)
1
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; GCD(5, 0)
5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; GCD(0, 5)
5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; GCD(5)
5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; GCD(14, 42, 21)
7
</code></pre>


</details>
<details id="int"><summary >
#### INT
<code>__INT__(value)</code>
<a class="headerlink" href="#int" title="Permanent link">#</a>
</summary>
Rounds a number down to the nearest integer that is less than or equal to it.



<pre><code class="language-python">&gt;&gt;&gt; INT(8.9)
8
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; INT(-8.9)
-9
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; 19.5-INT(19.5)
0.5
</code></pre>


</details>
<details id="lcm"><summary >
#### LCM
<code>__LCM__(value1, *more_values)</code>
<a class="headerlink" href="#lcm" title="Permanent link">#</a>
</summary>
Returns the least common multiple of one or more integers.



<pre><code class="language-python">&gt;&gt;&gt; LCM(5, 2)
10
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; LCM(24, 36)
72
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; LCM(0, 5)
0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; LCM(5)
5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; LCM(10, 100)
100
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; LCM(12, 18)
36
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; LCM(12, 18, 24)
72
</code></pre>


</details>
<details id="ln"><summary >
#### LN
<code>__LN__(value)</code>
<a class="headerlink" href="#ln" title="Permanent link">#</a>
</summary>
Returns the the logarithm of a number, base e (Euler's number).



<pre><code class="language-python">&gt;&gt;&gt; round(LN(86), 7)
4.4543473
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(LN(2.7182818), 7)
1.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(LN(EXP(3)), 10)
3.0
</code></pre>


</details>
<details id="log"><summary >
#### LOG
<code>__LOG__(value, base=10)</code>
<a class="headerlink" href="#log" title="Permanent link">#</a>
</summary>
Returns the the logarithm of a number given a base.



<pre><code class="language-python">&gt;&gt;&gt; LOG(10)
1.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; LOG(8, 2)
3.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(LOG(86, 2.7182818), 7)
4.4543473
</code></pre>


</details>
<details id="log10"><summary >
#### LOG10
<code>__LOG10__(value)</code>
<a class="headerlink" href="#log10" title="Permanent link">#</a>
</summary>
Returns the the logarithm of a number, base 10.



<pre><code class="language-python">&gt;&gt;&gt; round(LOG10(86), 9)
1.934498451
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; LOG10(10)
1.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; LOG10(100000)
5.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; LOG10(10**5)
5.0
</code></pre>


</details>
<details id="mod"><summary >
#### MOD
<code>__MOD__(dividend, divisor)</code>
<a class="headerlink" href="#mod" title="Permanent link">#</a>
</summary>
Returns the result of the modulo operator, the remainder after a division operation.



<pre><code class="language-python">&gt;&gt;&gt; MOD(3, 2)
1
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MOD(-3, 2)
1
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MOD(3, -2)
-1
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MOD(-3, -2)
-1
</code></pre>


</details>
<details id="mround"><summary >
#### MROUND
<code>__MROUND__(value, factor)</code>
<a class="headerlink" href="#mround" title="Permanent link">#</a>
</summary>
Rounds one number to the nearest integer multiple of another.



<pre><code class="language-python">&gt;&gt;&gt; MROUND(10, 3)
9
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MROUND(-10, -3)
-9
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(MROUND(1.3, 0.2), 10)
1.4
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MROUND(5, -2)
Traceback (most recent call last):
  ...
ValueError: factor argument invalid
</code></pre>


</details>
<details id="multinomial"><summary >
#### MULTINOMIAL
<code>__MULTINOMIAL__(value1, *more_values)</code>
<a class="headerlink" href="#multinomial" title="Permanent link">#</a>
</summary>
Returns the factorial of the sum of values divided by the product of the values' factorials.



<pre><code class="language-python">&gt;&gt;&gt; MULTINOMIAL(2, 3, 4)
1260
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MULTINOMIAL(3)
1
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MULTINOMIAL(1,2,3)
60
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MULTINOMIAL(0,2,4,6)
13860
</code></pre>


</details>
<details id="num"><summary >
#### NUM
<code>__NUM__(value)</code>
<a class="headerlink" href="#num" title="Permanent link">#</a>
</summary>
For a Python floating-point value that's actually an integer, returns a Python integer type.
Otherwise, returns the value unchanged. This is helpful sometimes when a value comes from a
Numeric Grist column (represented as floats), but when int values are actually expected.



<pre><code class="language-python">&gt;&gt;&gt; NUM(-17.0)
-17
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; NUM(1.5)
1.5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; NUM(4)
4
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; NUM(&quot;NA&quot;)
'NA'
</code></pre>


</details>
<details id="odd"><summary >
#### ODD
<code>__ODD__(value)</code>
<a class="headerlink" href="#odd" title="Permanent link">#</a>
</summary>
Rounds a number up to the nearest odd integer.



<pre><code class="language-python">&gt;&gt;&gt; ODD(1.5)
3
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ODD(3)
3
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ODD(2)
3
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ODD(-1)
-1
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ODD(-2)
-3
</code></pre>


</details>
<details id="pi"><summary >
#### PI
<code>__PI__()</code>
<a class="headerlink" href="#pi" title="Permanent link">#</a>
</summary>
Returns the value of Pi to 14 decimal places.



<pre><code class="language-python">&gt;&gt;&gt; round(PI(), 9)
3.141592654
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(PI()/2, 9)
1.570796327
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(PI()*9, 8)
28.27433388
</code></pre>


</details>
<details id="power"><summary >
#### POWER
<code>__POWER__(base, exponent)</code>
<a class="headerlink" href="#power" title="Permanent link">#</a>
</summary>
Returns a number raised to a power.



<pre><code class="language-python">&gt;&gt;&gt; POWER(5,2)
25.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(POWER(98.6,3.2), 3)
2401077.222
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(POWER(4,5.0/4), 9)
5.656854249
</code></pre>


</details>
<details id="product"><summary >
#### PRODUCT
<code>__PRODUCT__(factor1, *more_factors)</code>
<a class="headerlink" href="#product" title="Permanent link">#</a>
</summary>
Returns the result of multiplying a series of numbers together. Each argument may be a number or
an array.



<pre><code class="language-python">&gt;&gt;&gt; PRODUCT([5,15,30])
2250
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; PRODUCT([5,15,30], 2)
4500
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; PRODUCT(5,15,[30],[2])
4500
</code></pre>

</details>
<details id="quotient"><summary >
#### QUOTIENT
<code>__QUOTIENT__(dividend, divisor)</code>
<a class="headerlink" href="#quotient" title="Permanent link">#</a>
</summary>
Returns one number divided by another, without the remainder.



<pre><code class="language-python">&gt;&gt;&gt; QUOTIENT(5, 2)
2
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; QUOTIENT(4.5, 3.1)
1
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; QUOTIENT(-10, 3)
-3
</code></pre>


</details>
<details id="radians"><summary >
#### RADIANS
<code>__RADIANS__(angle)</code>
<a class="headerlink" href="#radians" title="Permanent link">#</a>
</summary>
Converts an angle value in degrees to radians.



<pre><code class="language-python">&gt;&gt;&gt; round(RADIANS(270), 6)
4.712389
</code></pre>


</details>
<details id="rand"><summary >
#### RAND
<code>__RAND__()</code>
<a class="headerlink" href="#rand" title="Permanent link">#</a>
</summary>
Returns a random number between 0 inclusive and 1 exclusive.
</details>
<details id="randbetween"><summary >
#### RANDBETWEEN
<code>__RANDBETWEEN__(low, high)</code>
<a class="headerlink" href="#randbetween" title="Permanent link">#</a>
</summary>
Returns a uniformly random integer between two values, inclusive.
</details>
<details id="roman"><summary >
#### ROMAN
<code>__ROMAN__(number, form_unused=None)</code>
<a class="headerlink" href="#roman" title="Permanent link">#</a>
</summary>
Formats a number in Roman numerals. The second argument is ignored in this implementation.



<pre><code class="language-python">&gt;&gt;&gt; ROMAN(499,0)
'CDXCIX'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ROMAN(499.2,0)
'CDXCIX'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ROMAN(57)
'LVII'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ROMAN(1912)
'MCMXII'
</code></pre>


</details>
<details id="round"><summary >
#### ROUND
<code>__ROUND__(value, places=0)</code>
<a class="headerlink" href="#round" title="Permanent link">#</a>
</summary>
Rounds a number to a certain number of decimal places,
by default to the nearest whole number if the number of places is not given.

Rounds away from zero ('up' for positive numbers)
in the case of a tie, i.e. when the last digit is 5.



<pre><code class="language-python">&gt;&gt;&gt; ROUND(1.4)
1.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ROUND(1.5)
2.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ROUND(2.5)
3.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ROUND(-2.5)
-3.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ROUND(2.15, 1)
2.2
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ROUND(-1.475, 2)
-1.48
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ROUND(21.5, -1)
20.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ROUND(626.3,-3)
1000.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ROUND(1.98,-1)
0.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ROUND(-50.55,-2)
-100.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ROUND(0)
0.0
</code></pre>


</details>
<details id="rounddown"><summary >
#### ROUNDDOWN
<code>__ROUNDDOWN__(value, places=0)</code>
<a class="headerlink" href="#rounddown" title="Permanent link">#</a>
</summary>
Rounds a number to a certain number of decimal places, always rounding down towards zero.



<pre><code class="language-python">&gt;&gt;&gt; ROUNDDOWN(3.2, 0)
3
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ROUNDDOWN(76.9,0)
76
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ROUNDDOWN(3.14159, 3)
3.141
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ROUNDDOWN(-3.14159, 1)
-3.1
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ROUNDDOWN(31415.92654, -2)
31400
</code></pre>


</details>
<details id="roundup"><summary >
#### ROUNDUP
<code>__ROUNDUP__(value, places=0)</code>
<a class="headerlink" href="#roundup" title="Permanent link">#</a>
</summary>
Rounds a number to a certain number of decimal places, always rounding up away from zero.



<pre><code class="language-python">&gt;&gt;&gt; ROUNDUP(3.2,0)
4
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ROUNDUP(76.9,0)
77
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ROUNDUP(3.14159, 3)
3.142
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ROUNDUP(-3.14159, 1)
-3.2
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; ROUNDUP(31415.92654, -2)
31500
</code></pre>


</details>
<details id="seriessum"><summary >
#### SERIESSUM
<code>__SERIESSUM__(x, n, m, a)</code>
<a class="headerlink" href="#seriessum" title="Permanent link">#</a>
</summary>
Given parameters x, n, m, and a, returns the power series sum a_1*x^n + a_2*x^(n+m)
+ ... + a_i*x^(n+(i-1)m), where i is the number of entries in range `a`.



<pre><code class="language-python">&gt;&gt;&gt; SERIESSUM(1,0,1,1)
1
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SERIESSUM(2,1,0,[1,2,3])
12
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SERIESSUM(-3,1,1,[2,4,6])
-132
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(SERIESSUM(PI()/4,0,2,[1,-1./FACT(2),1./FACT(4),-1./FACT(6)]), 6)
0.707103
</code></pre>


</details>
<details id="sign"><summary >
#### SIGN
<code>__SIGN__(value)</code>
<a class="headerlink" href="#sign" title="Permanent link">#</a>
</summary>
Given an input number, returns `-1` if it is negative, `1` if positive, and `0` if it is zero.



<pre><code class="language-python">&gt;&gt;&gt; SIGN(10)
1
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SIGN(4.0-4.0)
0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SIGN(-0.00001)
-1
</code></pre>


</details>
<details id="sin"><summary >
#### SIN
<code>__SIN__(angle)</code>
<a class="headerlink" href="#sin" title="Permanent link">#</a>
</summary>
Returns the sine of an angle provided in radians.



<pre><code class="language-python">&gt;&gt;&gt; round(SIN(PI()), 10)
0.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SIN(PI()/2)
1.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(SIN(30*PI()/180), 10)
0.5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(SIN(RADIANS(30)), 10)
0.5
</code></pre>


</details>
<details id="sinh"><summary >
#### SINH
<code>__SINH__(value)</code>
<a class="headerlink" href="#sinh" title="Permanent link">#</a>
</summary>
Returns the hyperbolic sine of any real number.



<pre><code class="language-python">&gt;&gt;&gt; round(2.868*SINH(0.0342*1.03), 7)
0.1010491
</code></pre>


</details>
<details id="sqrt"><summary >
#### SQRT
<code>__SQRT__(value)</code>
<a class="headerlink" href="#sqrt" title="Permanent link">#</a>
</summary>
Returns the positive square root of a positive number.



<pre><code class="language-python">&gt;&gt;&gt; SQRT(16)
4.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SQRT(-16)
Traceback (most recent call last):
  ...
ValueError: math domain error
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SQRT(ABS(-16))
4.0
</code></pre>


</details>
<details id="sqrtpi"><summary >
#### SQRTPI
<code>__SQRTPI__(value)</code>
<a class="headerlink" href="#sqrtpi" title="Permanent link">#</a>
</summary>
Returns the positive square root of the product of Pi and the given positive number.



<pre><code class="language-python">&gt;&gt;&gt; round(SQRTPI(1), 6)
1.772454
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(SQRTPI(2), 6)
2.506628
</code></pre>


</details>
<details id="subtotal"><summary class="unimplemented">
#### SUBTOTAL
<code>__SUBTOTAL__(function_code, range1, range2)</code>
<a class="headerlink" href="#subtotal" title="Permanent link">#</a>
</summary>
Returns a subtotal for a vertical range of cells using a specified aggregation function.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="sum"><summary >
#### SUM
<code>__SUM__(value1, *more_values)</code>
<a class="headerlink" href="#sum" title="Permanent link">#</a>
</summary>
Returns the sum of a series of numbers. Each argument may be a number or an array.
Non-numeric values are ignored.



<pre><code class="language-python">&gt;&gt;&gt; SUM([5,15,30])
50
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SUM([5.,15,30], 2)
52.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SUM(5,15,[30],[2])
52
</code></pre>

</details>
<details id="sumif"><summary class="unimplemented">
#### SUMIF
<code>__SUMIF__(records, criterion, sum_range)</code>
<a class="headerlink" href="#sumif" title="Permanent link">#</a>
</summary>
Returns a conditional sum across a range.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="sumifs"><summary class="unimplemented">
#### SUMIFS
<code>__SUMIFS__(sum_range, criteria_range1, criterion1, *args)</code>
<a class="headerlink" href="#sumifs" title="Permanent link">#</a>
</summary>
Returns the sum of a range depending on multiple criteria.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="sumproduct"><summary >
#### SUMPRODUCT
<code>__SUMPRODUCT__(array1, *more_arrays)</code>
<a class="headerlink" href="#sumproduct" title="Permanent link">#</a>
</summary>
Multiplies corresponding components in two equally-sized arrays,
and returns the sum of those products.



<pre><code class="language-python">&gt;&gt;&gt; SUMPRODUCT([3,8,1,4,6,9], [2,6,5,7,7,3])
156
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SUMPRODUCT([], [], [])
0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SUMPRODUCT([-0.25], [-2], [-3])
-1.5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SUMPRODUCT([-0.25, -0.25], [-2, -2], [-3, -3])
-3.0
</code></pre>


</details>
<details id="sumsq"><summary class="unimplemented">
#### SUMSQ
<code>__SUMSQ__(value1, value2)</code>
<a class="headerlink" href="#sumsq" title="Permanent link">#</a>
</summary>
Returns the sum of the squares of a series of numbers and/or cells.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="tan"><summary >
#### TAN
<code>__TAN__(angle)</code>
<a class="headerlink" href="#tan" title="Permanent link">#</a>
</summary>
Returns the tangent of an angle provided in radians.



<pre><code class="language-python">&gt;&gt;&gt; round(TAN(0.785), 8)
0.99920399
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(TAN(45*PI()/180), 10)
1.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(TAN(RADIANS(45)), 10)
1.0
</code></pre>


</details>
<details id="tanh"><summary >
#### TANH
<code>__TANH__(value)</code>
<a class="headerlink" href="#tanh" title="Permanent link">#</a>
</summary>
Returns the hyperbolic tangent of any real number.



<pre><code class="language-python">&gt;&gt;&gt; round(TANH(-2), 6)
-0.964028
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; TANH(0)
0.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; round(TANH(0.5), 6)
0.462117
</code></pre>


</details>
<details id="trunc"><summary >
#### TRUNC
<code>__TRUNC__(value, places=0)</code>
<a class="headerlink" href="#trunc" title="Permanent link">#</a>
</summary>
Truncates a number to a certain number of significant digits by omitting less significant
digits.



<pre><code class="language-python">&gt;&gt;&gt; TRUNC(8.9)
8
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; TRUNC(-8.9)
-8
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; TRUNC(0.45)
0
</code></pre>


</details>
<details id="uuid"><summary >
#### UUID
<code>__UUID__()</code>
<a class="headerlink" href="#uuid" title="Permanent link">#</a>
</summary>
Generate a random UUID-formatted string identifier.

Since UUID() produces a different value each time it's called, it is best to use it in
[trigger formula](formulas.md#trigger-formulas) for new records.
This would only calculate UUID() once and freeze the calculated value. By contrast, a regular
formula may get recalculated any time the document is reloaded, producing a different value for
UUID() each time.
</details>
<h3 id="schedule">Schedule<a class="headerlink" href="#schedule" title="Permanent link">#</a></h3>
<details id="schedule"><summary >
#### SCHEDULE
<code>__SCHEDULE__(schedule, start=None, count=10, end=None)</code>
<a class="headerlink" href="#schedule" title="Permanent link">#</a>
</summary>
Returns the list of `datetime` objects generated according to the `schedule` string. Starts at
`start`, which defaults to NOW(). Generates at most `count` results (10 by default). If `end` is
given, stops there.

The schedule has the format "INTERVAL: SLOTS, ...". For example:

    annual: Jan-15, Apr-15, Jul-15  -- Three times a year on given dates at midnight.
    annual: 1/15, 4/15, 7/15        -- Same as above.
    monthly: /1 2pm, /15 2pm        -- The 1st and the 15th of each month, at 2pm.
    3-months: /10, +1m /20           -- Every 3 months on the 10th of month 1, 20th of month 2.
    weekly: Mo 9am, Tu 9am, Fr 2pm  -- Three times a week at specified times.
    2-weeks: Mo, +1w Tu             -- Every 2 weeks on Monday of week 1, Tuesday of week 2.
    daily: 07:30, 21:00             -- Twice a day at specified times.
    2-day: 12am, 4pm, +1d 8am       -- Three times every two days, evenly spaced.
    hourly: :15, :45                -- 15 minutes before and after each hour.
    4-hour: :00, 1:20, 2:40         -- Three times every 4 hours, evenly spaced.
    10-minute: +0s                  -- Every 10 minutes on the minute.

INTERVAL must be either of the form `N-unit` where `N` is a number and `unit` is one of `year`,
`month`, `week`, `day`, `hour`; or one of the aliases: `annual`, `monthly`, `weekly`, `daily`,
`hourly`, which mean `1-year`, `1-month`, etc.

SLOTS support the following units:

    `Jan-15` or `1/15`    -- Month and day of the month; available when INTERVAL is year-based.
    `/15`                 -- Day of the month, available when INTERVAL is month-based.
    `Mon`, `Mo`, `Friday` -- Day of the week (or abbreviation), when INTERVAL is week-based.
    10am, 1:30pm, 15:45   -- Time of day, available for day-based or longer intervals.
    :45, :00              -- Minutes of the hour, available when INTERVAL is hour-based.
    +1d, +15d             -- How many days to add to start of INTERVAL.
    +1w                   -- How many weeks to add to start of INTERVAL.
    +1m                   -- How many months to add to start of INTERVAL.

The SLOTS are always relative to the INTERVAL rather than to `start`. Week-based intervals start
on Sunday. E.g. `weekly: +1d, +4d` is the same as `weekly: Mon, Thu`, and generates times on
Mondays and Thursdays regardless of `start`.

The first generated time is determined by the *unit* of the INTERVAL without regard to the
multiple. E.g. both "2-week: Mon" and "3-week: Mon" start on the first Monday after `start`, and
then generate either every second or every third Monday after that. Similarly, `24-hour: :00`
starts with the first top-of-the-hour after `start` (not with midnight), and then repeats every
24 hours. To start with the midnight after `start`, use `daily: 0:00`.

For interval units of a day or longer, if time-of-day is not specified, it defaults to midnight.

The time zone of `start` determines the time zone of the generated times.



<pre><code class="language-python">&gt;&gt;&gt; def show(dates): return [d.strftime(&quot;%Y-%m-%d %H:%M&quot;) for d in dates]

</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; start = datetime(2018, 9, 4, 14, 0);   # 2pm on Tue, Sep 4 2018.

</code></pre>




<pre><code class="language-python">&gt;&gt;&gt; show(SCHEDULE('annual: Jan-15, Apr-15, Jul-15, Oct-15', start=start, count=4))
['2018-10-15 00:00', '2019-01-15 00:00', '2019-04-15 00:00', '2019-07-15 00:00']
</code></pre>




<pre><code class="language-python">&gt;&gt;&gt; show(SCHEDULE('annual: 1/15, 4/15, 7/15', start=start, count=4))
['2019-01-15 00:00', '2019-04-15 00:00', '2019-07-15 00:00', '2020-01-15 00:00']
</code></pre>




<pre><code class="language-python">&gt;&gt;&gt; show(SCHEDULE('monthly: /1 2pm, /15 5pm', start=start, count=4))
['2018-09-15 17:00', '2018-10-01 14:00', '2018-10-15 17:00', '2018-11-01 14:00']
</code></pre>




<pre><code class="language-python">&gt;&gt;&gt; show(SCHEDULE('3-months: /10, +1m /20', start=start, count=4))
['2018-09-10 00:00', '2018-10-20 00:00', '2018-12-10 00:00', '2019-01-20 00:00']
</code></pre>




<pre><code class="language-python">&gt;&gt;&gt; show(SCHEDULE('weekly: Mo 9am, Tu 9am, Fr 2pm', start=start, count=4))
['2018-09-07 14:00', '2018-09-10 09:00', '2018-09-11 09:00', '2018-09-14 14:00']
</code></pre>




<pre><code class="language-python">&gt;&gt;&gt; show(SCHEDULE('2-weeks: Mo, +1w Tu', start=start, count=4))
['2018-09-11 00:00', '2018-09-17 00:00', '2018-09-25 00:00', '2018-10-01 00:00']
</code></pre>




<pre><code class="language-python">&gt;&gt;&gt; show(SCHEDULE('daily: 07:30, 21:00', start=start, count=4))
['2018-09-04 21:00', '2018-09-05 07:30', '2018-09-05 21:00', '2018-09-06 07:30']
</code></pre>




<pre><code class="language-python">&gt;&gt;&gt; show(SCHEDULE('2-day: 12am, 4pm, +1d 8am', start=start, count=4))
['2018-09-04 16:00', '2018-09-05 08:00', '2018-09-06 00:00', '2018-09-06 16:00']
</code></pre>




<pre><code class="language-python">&gt;&gt;&gt; show(SCHEDULE('hourly: :15, :45', start=start, count=4))
['2018-09-04 14:15', '2018-09-04 14:45', '2018-09-04 15:15', '2018-09-04 15:45']
</code></pre>




<pre><code class="language-python">&gt;&gt;&gt; show(SCHEDULE('4-hour: :00, +1H :20, +2H :40', start=start, count=4))
['2018-09-04 14:00', '2018-09-04 15:20', '2018-09-04 16:40', '2018-09-04 18:00']
</code></pre>


</details>
<h3 id="stats">Stats<a class="headerlink" href="#stats" title="Permanent link">#</a></h3>
<details id="avedev"><summary class="unimplemented">
#### AVEDEV
<code>__AVEDEV__(value1, value2)</code>
<a class="headerlink" href="#avedev" title="Permanent link">#</a>
</summary>
Calculates the average of the magnitudes of deviations of data from a dataset's mean.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="average"><summary >
#### AVERAGE
<code>__AVERAGE__(value, *more_values)</code>
<a class="headerlink" href="#average" title="Permanent link">#</a>
</summary>
Returns the numerical average value in a dataset, ignoring non-numerical values.

Each argument may be a value or an array. Values that are not numbers, including logical
and blank values, and text representations of numbers, are ignored.



<pre><code class="language-python">&gt;&gt;&gt; AVERAGE([2, -1.0, 11])
4.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; AVERAGE([2, -1, 11, &quot;Hello&quot;])
4.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; AVERAGE([2, -1, &quot;Hello&quot;, DATE(2015,1,1)], True, [False, &quot;123&quot;, &quot;&quot;, 11])
4.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; AVERAGE(False, True)
Traceback (most recent call last):
  ...
ZeroDivisionError: float division by zero
</code></pre>


</details>
<details id="averagea"><summary >
#### AVERAGEA
<code>__AVERAGEA__(value, *more_values)</code>
<a class="headerlink" href="#averagea" title="Permanent link">#</a>
</summary>
Returns the numerical average value in a dataset, counting non-numerical values as 0.

Each argument may be a value of an array. Values that are not numbers, including dates and text
representations of numbers, are counted as 0 (zero). Logical value of True is counted as 1, and
False as 0.



<pre><code class="language-python">&gt;&gt;&gt; AVERAGEA([2, -1.0, 11])
4.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; AVERAGEA([2, -1, 11, &quot;Hello&quot;])
3.0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; AVERAGEA([2, -1, &quot;Hello&quot;, DATE(2015,1,1)], True, [False, &quot;123&quot;, &quot;&quot;, 11.5])
1.5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; AVERAGEA(False, True)
0.5
</code></pre>


</details>
<details id="averageif"><summary class="unimplemented">
#### AVERAGEIF
<code>__AVERAGEIF__(criteria_range, criterion, average_range=None)</code>
<a class="headerlink" href="#averageif" title="Permanent link">#</a>
</summary>
Returns the average of a range depending on criteria.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="averageifs"><summary class="unimplemented">
#### AVERAGEIFS
<code>__AVERAGEIFS__(average_range, criteria_range1, criterion1, *args)</code>
<a class="headerlink" href="#averageifs" title="Permanent link">#</a>
</summary>
Returns the average of a range depending on multiple criteria.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="average_weighted"><summary >
#### AVERAGE_WEIGHTED
<code>__AVERAGE_WEIGHTED__(pairs)</code>
<a class="headerlink" href="#average_weighted" title="Permanent link">#</a>
</summary>
Given a list of (value, weight) pairs, finds the average of the values weighted by the
corresponding weights. Ignores any pairs with a non-numerical value or weight.

If you have two lists, of values and weights, use the Python built-in zip() function to create a
list of pairs.



<pre><code class="language-python">&gt;&gt;&gt; AVERAGE_WEIGHTED(((95, .25), (90, .1), (&quot;X&quot;, .5), (85, .15), (88, .2), (82, .3), (70, None)))
87.7
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; AVERAGE_WEIGHTED(zip([95, 90, &quot;X&quot;, 85, 88, 82, 70], [25, 10, 50, 15, 20, 30, None]))
87.7
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; AVERAGE_WEIGHTED(zip([95, 90, False, 85, 88, 82, 70], [.25, .1, .5, .15, .2, .3, True]))
87.7
</code></pre>


</details>
<details id="binomdist"><summary class="unimplemented">
#### BINOMDIST
<code>__BINOMDIST__(num_successes, num_trials, prob_success, cumulative)</code>
<a class="headerlink" href="#binomdist" title="Permanent link">#</a>
</summary>
Calculates the probability of drawing a certain number of successes (or a maximum number of
successes) in a certain number of tries given a population of a certain size containing a
certain number of successes, with replacement of draws.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="confidence"><summary class="unimplemented">
#### CONFIDENCE
<code>__CONFIDENCE__(alpha, standard_deviation, pop_size)</code>
<a class="headerlink" href="#confidence" title="Permanent link">#</a>
</summary>
Calculates the width of half the confidence interval for a normal distribution.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="correl"><summary class="unimplemented">
#### CORREL
<code>__CORREL__(data_y, data_x)</code>
<a class="headerlink" href="#correl" title="Permanent link">#</a>
</summary>
Calculates r, the Pearson product-moment correlation coefficient of a dataset.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="count"><summary >
#### COUNT
<code>__COUNT__(value, *more_values)</code>
<a class="headerlink" href="#count" title="Permanent link">#</a>
</summary>
Returns the count of numerical and date/datetime values in a dataset,
ignoring other types of values.

Each argument may be a value or an array. Values that are not numbers or dates, including logical
and blank values, and text representations of numbers, are ignored.



<pre><code class="language-python">&gt;&gt;&gt; COUNT([2, -1.0, 11])
3
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; COUNT([2, -1, 11, &quot;Hello&quot;])
3
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; COUNT([DATE(2000, 1, 1), DATE(2000, 1, 2), DATE(2000, 1, 3), &quot;Hello&quot;])
3
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; COUNT([2, -1, &quot;Hello&quot;, DATE(2015,1,1)], True, [False, &quot;123&quot;, &quot;&quot;, 11.5])
4
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; COUNT(False, True)
0
</code></pre>


</details>
<details id="counta"><summary >
#### COUNTA
<code>__COUNTA__(value, *more_values)</code>
<a class="headerlink" href="#counta" title="Permanent link">#</a>
</summary>
Returns the count of all values in a dataset, including non-numerical values.

Each argument may be a value or an array.



<pre><code class="language-python">&gt;&gt;&gt; COUNTA([2, -1.0, 11])
3
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; COUNTA([2, -1, 11, &quot;Hello&quot;])
4
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; COUNTA([2, -1, &quot;Hello&quot;, DATE(2015,1,1)], True, [False, &quot;123&quot;, &quot;&quot;, 11.5])
9
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; COUNTA(False, True)
2
</code></pre>


</details>
<details id="covar"><summary class="unimplemented">
#### COVAR
<code>__COVAR__(data_y, data_x)</code>
<a class="headerlink" href="#covar" title="Permanent link">#</a>
</summary>
Calculates the covariance of a dataset.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="critbinom"><summary class="unimplemented">
#### CRITBINOM
<code>__CRITBINOM__(num_trials, prob_success, target_prob)</code>
<a class="headerlink" href="#critbinom" title="Permanent link">#</a>
</summary>
Calculates the smallest value for which the cumulative binomial distribution is greater than or equal to a specified criteria.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="devsq"><summary class="unimplemented">
#### DEVSQ
<code>__DEVSQ__(value1, value2)</code>
<a class="headerlink" href="#devsq" title="Permanent link">#</a>
</summary>
Calculates the sum of squares of deviations based on a sample.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="expondist"><summary class="unimplemented">
#### EXPONDIST
<code>__EXPONDIST__(x, lambda_, cumulative)</code>
<a class="headerlink" href="#expondist" title="Permanent link">#</a>
</summary>
Returns the value of the exponential distribution function with a specified lambda at a specified value.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="fdist"><summary class="unimplemented">
#### FDIST
<code>__FDIST__(x, degrees_freedom1, degrees_freedom2)</code>
<a class="headerlink" href="#fdist" title="Permanent link">#</a>
</summary>
Calculates the right-tailed F probability distribution (degree of diversity) for two data sets
with given input x. Alternately called Fisher-Snedecor distribution or Snedecor's F
distribution.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="fisher"><summary class="unimplemented">
#### FISHER
<code>__FISHER__(value)</code>
<a class="headerlink" href="#fisher" title="Permanent link">#</a>
</summary>
Returns the Fisher transformation of a specified value.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="fisherinv"><summary class="unimplemented">
#### FISHERINV
<code>__FISHERINV__(value)</code>
<a class="headerlink" href="#fisherinv" title="Permanent link">#</a>
</summary>
Returns the inverse Fisher transformation of a specified value.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="forecast"><summary class="unimplemented">
#### FORECAST
<code>__FORECAST__(x, data_y, data_x)</code>
<a class="headerlink" href="#forecast" title="Permanent link">#</a>
</summary>
Calculates the expected y-value for a specified x based on a linear regression of a dataset.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="f_dist"><summary class="unimplemented">
#### F_DIST
<code>__F_DIST__(x, degrees_freedom1, degrees_freedom2, cumulative)</code>
<a class="headerlink" href="#f_dist" title="Permanent link">#</a>
</summary>
Calculates the left-tailed F probability distribution (degree of diversity) for two data sets
with given input x. Alternately called Fisher-Snedecor distribution or Snedecor's F
distribution.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="f_dist_rt"><summary class="unimplemented">
#### F_DIST_RT
<code>__F_DIST_RT__(x, degrees_freedom1, degrees_freedom2)</code>
<a class="headerlink" href="#f_dist_rt" title="Permanent link">#</a>
</summary>
Calculates the right-tailed F probability distribution (degree of diversity) for two data sets
with given input x. Alternately called Fisher-Snedecor distribution or Snedecor's F
distribution.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="geomean"><summary class="unimplemented">
#### GEOMEAN
<code>__GEOMEAN__(value1, value2)</code>
<a class="headerlink" href="#geomean" title="Permanent link">#</a>
</summary>
Calculates the geometric mean of a dataset.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="harmean"><summary class="unimplemented">
#### HARMEAN
<code>__HARMEAN__(value1, value2)</code>
<a class="headerlink" href="#harmean" title="Permanent link">#</a>
</summary>
Calculates the harmonic mean of a dataset.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="hypgeomdist"><summary class="unimplemented">
#### HYPGEOMDIST
<code>__HYPGEOMDIST__(num_successes, num_draws, successes_in_pop, pop_size)</code>
<a class="headerlink" href="#hypgeomdist" title="Permanent link">#</a>
</summary>
Calculates the probability of drawing a certain number of successes in a certain number of tries given a population of a certain size containing a certain number of successes, without replacement of draws.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="intercept"><summary class="unimplemented">
#### INTERCEPT
<code>__INTERCEPT__(data_y, data_x)</code>
<a class="headerlink" href="#intercept" title="Permanent link">#</a>
</summary>
Calculates the y-value at which the line resulting from linear regression of a dataset will intersect the y-axis (x=0).

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="kurt"><summary class="unimplemented">
#### KURT
<code>__KURT__(value1, value2)</code>
<a class="headerlink" href="#kurt" title="Permanent link">#</a>
</summary>
Calculates the kurtosis of a dataset, which describes the shape, and in particular the "peakedness" of that dataset.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="large"><summary class="unimplemented">
#### LARGE
<code>__LARGE__(data, n)</code>
<a class="headerlink" href="#large" title="Permanent link">#</a>
</summary>
Returns the nth largest element from a data set, where n is user-defined.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="loginv"><summary class="unimplemented">
#### LOGINV
<code>__LOGINV__(x, mean, standard_deviation)</code>
<a class="headerlink" href="#loginv" title="Permanent link">#</a>
</summary>
Returns the value of the inverse log-normal cumulative distribution with given mean and standard deviation at a specified value.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="lognormdist"><summary class="unimplemented">
#### LOGNORMDIST
<code>__LOGNORMDIST__(x, mean, standard_deviation)</code>
<a class="headerlink" href="#lognormdist" title="Permanent link">#</a>
</summary>
Returns the value of the log-normal cumulative distribution with given mean and standard deviation at a specified value.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="max"><summary >
#### MAX
<code>__MAX__(value, *more_values)</code>
<a class="headerlink" href="#max" title="Permanent link">#</a>
</summary>
Returns the maximum value in a dataset, ignoring values other than numbers and dates/datetimes.

Each argument may be a value or an array. Values that are not numbers or dates, including logical
and blank values, and text representations of numbers, are ignored. Returns 0 if the arguments
contain no numbers or dates.



<pre><code class="language-python">&gt;&gt;&gt; MAX([2, -1.5, 11.5])
11.5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MAX([2, -1.5, &quot;Hello&quot;], True, [False, &quot;123&quot;, &quot;&quot;, 11.5])
11.5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MAX(True, -123)
-123
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MAX(&quot;123&quot;, -123)
-123
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MAX(&quot;Hello&quot;, &quot;123&quot;, True, False)
0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MAX(DATE(2015, 1, 1), DATE(2015, 1, 2))
datetime.date(2015, 1, 2)
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MAX(DATE(2015, 1, 1), datetime.datetime(2015, 1, 1, 12, 34, 56))
datetime.datetime(2015, 1, 1, 12, 34, 56)
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MAX(DATE(2015, 1, 2), datetime.datetime(2015, 1, 1, 12, 34, 56))
datetime.date(2015, 1, 2)
</code></pre>


</details>
<details id="maxa"><summary >
#### MAXA
<code>__MAXA__(value, *more_values)</code>
<a class="headerlink" href="#maxa" title="Permanent link">#</a>
</summary>
Returns the maximum numeric value in a dataset.

Each argument may be a value of an array. Values that are not numbers, including dates and text
representations of numbers, are counted as 0 (zero). Logical value of True is counted as 1, and
False as 0. Returns 0 if the arguments contain no numbers.



<pre><code class="language-python">&gt;&gt;&gt; MAXA([2, -1.5, 11.5])
11.5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MAXA([2, -1.5, &quot;Hello&quot;, DATE(2015, 1, 1)], True, [False, &quot;123&quot;, &quot;&quot;, 11.5])
11.5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MAXA(True, -123)
1
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MAXA(&quot;123&quot;, -123)
0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MAXA(&quot;Hello&quot;, &quot;123&quot;, DATE(2015, 1, 1))
0
</code></pre>


</details>
<details id="median"><summary >
#### MEDIAN
<code>__MEDIAN__(value, *more_values)</code>
<a class="headerlink" href="#median" title="Permanent link">#</a>
</summary>
Returns the median value in a numeric dataset, ignoring non-numerical values.

Each argument may be a value or an array. Values that are not numbers, including logical
and blank values, and text representations of numbers, are ignored.

Produces an error if the arguments contain no numbers.

The median is the middle number when all values are sorted. So half of the values in the dataset
are less than the median, and half of the values are greater. If there is an even number of
values in the dataset, returns the average of the two numbers in the middle.



<pre><code class="language-python">&gt;&gt;&gt; MEDIAN(1, 2, 3, 4, 5)
3
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MEDIAN(3, 5, 1, 4, 2)
3
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MEDIAN(range(10))
4.5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MEDIAN(&quot;Hello&quot;, &quot;123&quot;, DATE(2015, 1, 1), 12.3)
12.3
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MEDIAN(&quot;Hello&quot;, &quot;123&quot;, DATE(2015, 1, 1))
Traceback (most recent call last):
  ...
ValueError: MEDIAN requires at least one number
</code></pre>


</details>
<details id="min"><summary >
#### MIN
<code>__MIN__(value, *more_values)</code>
<a class="headerlink" href="#min" title="Permanent link">#</a>
</summary>
Returns the minimum value in a dataset, ignoring values other than numbers and dates/datetimes.

Each argument may be a value or an array. Values that are not numbers or dates, including logical
and blank values, and text representations of numbers, are ignored. Returns 0 if the arguments
contain no numbers or dates.



<pre><code class="language-python">&gt;&gt;&gt; MIN([2, -1.5, 11.5])
-1.5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MIN([2, -1.5, &quot;Hello&quot;], True, [False, &quot;123&quot;, &quot;&quot;, 11.5])
-1.5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MIN(True, 123)
123
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MIN(&quot;-123&quot;, 123)
123
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MIN(&quot;Hello&quot;, &quot;123&quot;, True, False)
0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MIN(DATE(2015, 1, 1), DATE(2015, 1, 2))
datetime.date(2015, 1, 1)
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MIN(DATE(2015, 1, 1), datetime.datetime(2015, 1, 1, 12, 34, 56))
datetime.date(2015, 1, 1)
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MIN(DATE(2015, 1, 2), datetime.datetime(2015, 1, 1, 12, 34, 56))
datetime.datetime(2015, 1, 1, 12, 34, 56)
</code></pre>


</details>
<details id="mina"><summary >
#### MINA
<code>__MINA__(value, *more_values)</code>
<a class="headerlink" href="#mina" title="Permanent link">#</a>
</summary>
Returns the minimum numeric value in a dataset.

Each argument may be a value of an array. Values that are not numbers, including dates and text
representations of numbers, are counted as 0 (zero). Logical value of True is counted as 1, and
False as 0. Returns 0 if the arguments contain no numbers.



<pre><code class="language-python">&gt;&gt;&gt; MINA([2, -1.5, 11.5])
-1.5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MINA([2, -1.5, &quot;Hello&quot;, DATE(2015, 1, 1)], True, [False, &quot;123&quot;, &quot;&quot;, 11.5])
-1.5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MINA(True, 123)
1
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MINA(&quot;-123&quot;, 123)
0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MINA(&quot;Hello&quot;, &quot;123&quot;, DATE(2015, 1, 1))
0
</code></pre>


</details>
<details id="mode"><summary class="unimplemented">
#### MODE
<code>__MODE__(value1, value2)</code>
<a class="headerlink" href="#mode" title="Permanent link">#</a>
</summary>
Returns the most commonly occurring value in a dataset.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="negbinomdist"><summary class="unimplemented">
#### NEGBINOMDIST
<code>__NEGBINOMDIST__(num_failures, num_successes, prob_success)</code>
<a class="headerlink" href="#negbinomdist" title="Permanent link">#</a>
</summary>
Calculates the probability of drawing a certain number of failures before a certain number of successes given a probability of success in independent trials.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="normdist"><summary class="unimplemented">
#### NORMDIST
<code>__NORMDIST__(x, mean, standard_deviation, cumulative)</code>
<a class="headerlink" href="#normdist" title="Permanent link">#</a>
</summary>
Returns the value of the normal distribution function (or normal cumulative distribution
function) for a specified value, mean, and standard deviation.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="norminv"><summary class="unimplemented">
#### NORMINV
<code>__NORMINV__(x, mean, standard_deviation)</code>
<a class="headerlink" href="#norminv" title="Permanent link">#</a>
</summary>
Returns the value of the inverse normal distribution function for a specified value, mean, and standard deviation.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="normsdist"><summary class="unimplemented">
#### NORMSDIST
<code>__NORMSDIST__(x)</code>
<a class="headerlink" href="#normsdist" title="Permanent link">#</a>
</summary>
Returns the value of the standard normal cumulative distribution function for a specified value.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="normsinv"><summary class="unimplemented">
#### NORMSINV
<code>__NORMSINV__(x)</code>
<a class="headerlink" href="#normsinv" title="Permanent link">#</a>
</summary>
Returns the value of the inverse standard normal distribution function for a specified value.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="pearson"><summary class="unimplemented">
#### PEARSON
<code>__PEARSON__(data_y, data_x)</code>
<a class="headerlink" href="#pearson" title="Permanent link">#</a>
</summary>
Calculates r, the Pearson product-moment correlation coefficient of a dataset.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="percentile"><summary class="unimplemented">
#### PERCENTILE
<code>__PERCENTILE__(data, percentile)</code>
<a class="headerlink" href="#percentile" title="Permanent link">#</a>
</summary>
Returns the value at a given percentile of a dataset.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="percentrank"><summary class="unimplemented">
#### PERCENTRANK
<code>__PERCENTRANK__(data, value, significant_digits=None)</code>
<a class="headerlink" href="#percentrank" title="Permanent link">#</a>
</summary>
Returns the percentage rank (percentile) of a specified value in a dataset.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="percentrank_exc"><summary class="unimplemented">
#### PERCENTRANK_EXC
<code>__PERCENTRANK_EXC__(data, value, significant_digits=None)</code>
<a class="headerlink" href="#percentrank_exc" title="Permanent link">#</a>
</summary>
Returns the percentage rank (percentile) from 0 to 1 exclusive of a specified value in a dataset.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="percentrank_inc"><summary class="unimplemented">
#### PERCENTRANK_INC
<code>__PERCENTRANK_INC__(data, value, significant_digits=None)</code>
<a class="headerlink" href="#percentrank_inc" title="Permanent link">#</a>
</summary>
Returns the percentage rank (percentile) from 0 to 1 inclusive of a specified value in a dataset.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="permut"><summary class="unimplemented">
#### PERMUT
<code>__PERMUT__(n, k)</code>
<a class="headerlink" href="#permut" title="Permanent link">#</a>
</summary>
Returns the number of ways to choose some number of objects from a pool of a given size of objects, considering order.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="poisson"><summary class="unimplemented">
#### POISSON
<code>__POISSON__(x, mean, cumulative)</code>
<a class="headerlink" href="#poisson" title="Permanent link">#</a>
</summary>
Returns the value of the Poisson distribution function (or Poisson cumulative distribution
function) for a specified value and mean.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="prob"><summary class="unimplemented">
#### PROB
<code>__PROB__(data, probabilities, low_limit, high_limit=None)</code>
<a class="headerlink" href="#prob" title="Permanent link">#</a>
</summary>
Given a set of values and corresponding probabilities, calculates the probability that a value chosen at random falls between two limits.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="quartile"><summary class="unimplemented">
#### QUARTILE
<code>__QUARTILE__(data, quartile_number)</code>
<a class="headerlink" href="#quartile" title="Permanent link">#</a>
</summary>
Returns a value nearest to a specified quartile of a dataset.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="rank_avg"><summary class="unimplemented">
#### RANK_AVG
<code>__RANK_AVG__(value, data, is_ascending=None)</code>
<a class="headerlink" href="#rank_avg" title="Permanent link">#</a>
</summary>
Returns the rank of a specified value in a dataset. If there is more than one entry of the same value in the dataset, the average rank of the entries will be returned.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="rank_eq"><summary class="unimplemented">
#### RANK_EQ
<code>__RANK_EQ__(value, data, is_ascending=None)</code>
<a class="headerlink" href="#rank_eq" title="Permanent link">#</a>
</summary>
Returns the rank of a specified value in a dataset. If there is more than one entry of the same value in the dataset, the top rank of the entries will be returned.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="rsq"><summary class="unimplemented">
#### RSQ
<code>__RSQ__(data_y, data_x)</code>
<a class="headerlink" href="#rsq" title="Permanent link">#</a>
</summary>
Calculates the square of r, the Pearson product-moment correlation coefficient of a dataset.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="skew"><summary class="unimplemented">
#### SKEW
<code>__SKEW__(value1, value2)</code>
<a class="headerlink" href="#skew" title="Permanent link">#</a>
</summary>
Calculates the skewness of a dataset, which describes the symmetry of that dataset about the mean.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="slope"><summary class="unimplemented">
#### SLOPE
<code>__SLOPE__(data_y, data_x)</code>
<a class="headerlink" href="#slope" title="Permanent link">#</a>
</summary>
Calculates the slope of the line resulting from linear regression of a dataset.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="small"><summary class="unimplemented">
#### SMALL
<code>__SMALL__(data, n)</code>
<a class="headerlink" href="#small" title="Permanent link">#</a>
</summary>
Returns the nth smallest element from a data set, where n is user-defined.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="standardize"><summary class="unimplemented">
#### STANDARDIZE
<code>__STANDARDIZE__(value, mean, standard_deviation)</code>
<a class="headerlink" href="#standardize" title="Permanent link">#</a>
</summary>
Calculates the normalized equivalent of a random variable given mean and standard deviation of the distribution.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="stdev"><summary >
#### STDEV
<code>__STDEV__(value, *more_values)</code>
<a class="headerlink" href="#stdev" title="Permanent link">#</a>
</summary>
Calculates the standard deviation based on a sample, ignoring non-numerical values.



<pre><code class="language-python">&gt;&gt;&gt; STDEV([2, 5, 8, 13, 10])
4.277849927241488
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; STDEV([2, 5, 8, 13, 10, True, False, &quot;Test&quot;])
4.277849927241488
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; STDEV([2, 5, 8, 13, 10], 3, 12, 15)
4.810702354423639
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; STDEV([2, 5, 8, 13, 10], [3, 12, 15])
4.810702354423639
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; STDEV([5])
Traceback (most recent call last):
  ...
ZeroDivisionError: float division by zero
</code></pre>


</details>
<details id="stdeva"><summary >
#### STDEVA
<code>__STDEVA__(value, *more_values)</code>
<a class="headerlink" href="#stdeva" title="Permanent link">#</a>
</summary>
Calculates the standard deviation based on a sample, setting text to the value `0`.



<pre><code class="language-python">&gt;&gt;&gt; STDEVA([2, 5, 8, 13, 10])
4.277849927241488
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; STDEVA([2, 5, 8, 13, 10, True, False, &quot;Test&quot;])
4.969550137731641
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; STDEVA([2, 5, 8, 13, 10], 1, 0, 0)
4.969550137731641
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; STDEVA([2, 5, 8, 13, 10], [1, 0, 0])
4.969550137731641
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; STDEVA([5])
Traceback (most recent call last):
  ...
ZeroDivisionError: float division by zero
</code></pre>


</details>
<details id="stdevp"><summary >
#### STDEVP
<code>__STDEVP__(value, *more_values)</code>
<a class="headerlink" href="#stdevp" title="Permanent link">#</a>
</summary>
Calculates the standard deviation based on an entire population, ignoring non-numerical values.



<pre><code class="language-python">&gt;&gt;&gt; STDEVP([2, 5, 8, 13, 10])
3.8262252939417984
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; STDEVP([2, 5, 8, 13, 10, True, False, &quot;Test&quot;])
3.8262252939417984
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; STDEVP([2, 5, 8, 13, 10], 3, 12, 15)
4.5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; STDEVP([2, 5, 8, 13, 10], [3, 12, 15])
4.5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; STDEVP([5])
0.0
</code></pre>


</details>
<details id="stdevpa"><summary >
#### STDEVPA
<code>__STDEVPA__(value, *more_values)</code>
<a class="headerlink" href="#stdevpa" title="Permanent link">#</a>
</summary>
Calculates the standard deviation based on an entire population, setting text to the value `0`.



<pre><code class="language-python">&gt;&gt;&gt; STDEVPA([2, 5, 8, 13, 10])
3.8262252939417984
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; STDEVPA([2, 5, 8, 13, 10, True, False, &quot;Test&quot;])
4.648588495446763
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; STDEVPA([2, 5, 8, 13, 10], 1, 0, 0)
4.648588495446763
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; STDEVPA([2, 5, 8, 13, 10], [1, 0, 0])
4.648588495446763
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; STDEVPA([5])
0.0
</code></pre>


</details>
<details id="steyx"><summary class="unimplemented">
#### STEYX
<code>__STEYX__(data_y, data_x)</code>
<a class="headerlink" href="#steyx" title="Permanent link">#</a>
</summary>
Calculates the standard error of the predicted y-value for each x in the regression of a dataset.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="tdist"><summary class="unimplemented">
#### TDIST
<code>__TDIST__(x, degrees_freedom, tails)</code>
<a class="headerlink" href="#tdist" title="Permanent link">#</a>
</summary>
Calculates the probability for Student's t-distribution with a given input (x).

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="tinv"><summary class="unimplemented">
#### TINV
<code>__TINV__(probability, degrees_freedom)</code>
<a class="headerlink" href="#tinv" title="Permanent link">#</a>
</summary>
Calculates the inverse of the two-tailed TDIST function.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="trimmean"><summary class="unimplemented">
#### TRIMMEAN
<code>__TRIMMEAN__(data, exclude_proportion)</code>
<a class="headerlink" href="#trimmean" title="Permanent link">#</a>
</summary>
Calculates the mean of a dataset excluding some proportion of data from the high and low ends of the dataset.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="ttest"><summary class="unimplemented">
#### TTEST
<code>__TTEST__(range1, range2, tails, type)</code>
<a class="headerlink" href="#ttest" title="Permanent link">#</a>
</summary>
Returns the probability associated with t-test. Determines whether two samples are likely to have come from the same two underlying populations that have the same mean.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="t_inv"><summary class="unimplemented">
#### T_INV
<code>__T_INV__(probability, degrees_freedom)</code>
<a class="headerlink" href="#t_inv" title="Permanent link">#</a>
</summary>
Calculates the negative inverse of the one-tailed TDIST function.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="t_inv_2t"><summary class="unimplemented">
#### T_INV_2T
<code>__T_INV_2T__(probability, degrees_freedom)</code>
<a class="headerlink" href="#t_inv_2t" title="Permanent link">#</a>
</summary>
Calculates the inverse of the two-tailed TDIST function.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="var"><summary class="unimplemented">
#### VAR
<code>__VAR__(value1, value2)</code>
<a class="headerlink" href="#var" title="Permanent link">#</a>
</summary>
Calculates the variance based on a sample.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="vara"><summary class="unimplemented">
#### VARA
<code>__VARA__(value1, value2)</code>
<a class="headerlink" href="#vara" title="Permanent link">#</a>
</summary>
Calculates an estimate of variance based on a sample, setting text to the value `0`.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="varp"><summary class="unimplemented">
#### VARP
<code>__VARP__(value1, value2)</code>
<a class="headerlink" href="#varp" title="Permanent link">#</a>
</summary>
Calculates the variance based on an entire population.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="varpa"><summary class="unimplemented">
#### VARPA
<code>__VARPA__(value1, value2)</code>
<a class="headerlink" href="#varpa" title="Permanent link">#</a>
</summary>
Calculates the variance based on an entire population, setting text to the value `0`.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="weibull"><summary class="unimplemented">
#### WEIBULL
<code>__WEIBULL__(x, shape, scale, cumulative)</code>
<a class="headerlink" href="#weibull" title="Permanent link">#</a>
</summary>
Returns the value of the Weibull distribution function (or Weibull cumulative distribution
function) for a specified shape and scale.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="ztest"><summary class="unimplemented">
#### ZTEST
<code>__ZTEST__(data, value, standard_deviation)</code>
<a class="headerlink" href="#ztest" title="Permanent link">#</a>
</summary>
Returns the two-tailed P-value of a Z-test with standard distribution.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<h3 id="text">Text<a class="headerlink" href="#text" title="Permanent link">#</a></h3>
<details id="char"><summary >
#### CHAR
<code>__CHAR__(table_number)</code>
<a class="headerlink" href="#char" title="Permanent link">#</a>
</summary>
Convert a number into a character according to the current Unicode table.
Same as `unichr(number)`.



<pre><code class="language-python">&gt;&gt;&gt; CHAR(65)
u'A'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; CHAR(33)
u'!'
</code></pre>


</details>
<details id="clean"><summary >
#### CLEAN
<code>__CLEAN__(text)</code>
<a class="headerlink" href="#clean" title="Permanent link">#</a>
</summary>
Returns the text with the non-printable characters removed.

This removes both characters with values 0 through 31, and other Unicode characters in the
"control characters" category.



<pre><code class="language-python">&gt;&gt;&gt; CLEAN(CHAR(9) + &quot;Monthly report&quot; + CHAR(10))
u'Monthly report'
</code></pre>


</details>
<details id="code"><summary >
#### CODE
<code>__CODE__(string)</code>
<a class="headerlink" href="#code" title="Permanent link">#</a>
</summary>
Returns the numeric Unicode map value of the first character in the string provided.
Same as `ord(string[0])`.



<pre><code class="language-python">&gt;&gt;&gt; CODE(&quot;A&quot;)
65
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; CODE(&quot;!&quot;)
33
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; CODE(&quot;!A&quot;)
33
</code></pre>


</details>
<details id="concat"><summary >
#### CONCAT
<code>__CONCAT__(string, *more_strings)</code>
<a class="headerlink" href="#concat" title="Permanent link">#</a>
</summary>
Joins together any number of text strings into one string. Also available under the name
`CONCATENATE`. Similar to the Python expression `"".join(array_of_strings)`.



<pre><code class="language-python">&gt;&gt;&gt; CONCAT(&quot;Stream population for &quot;, &quot;trout&quot;, &quot; &quot;, &quot;species&quot;, &quot; is &quot;, 32, &quot;/mile.&quot;)
u'Stream population for trout species is 32/mile.'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; CONCAT(&quot;In &quot;, 4, &quot; days it is &quot;, datetime.date(2016,1,1))
u'In 4 days it is 2016-01-01'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; CONCAT(&quot;abc&quot;)
u'abc'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; CONCAT(0, &quot;abc&quot;)
u'0abc'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; assert CONCAT(2, u&quot; cr√®me &quot;, u&quot;br√ªl√©e&quot;) == u'2 cr√®me br√ªl√©e'

</code></pre>


</details>
<details id="concatenate"><summary >
#### CONCATENATE
<code>__CONCATENATE__(string, *more_strings)</code>
<a class="headerlink" href="#concatenate" title="Permanent link">#</a>
</summary>
Joins together any number of text strings into one string. Also available under the name
`CONCAT`. Similar to the Python expression `"".join(array_of_strings)`.



<pre><code class="language-python">&gt;&gt;&gt; CONCATENATE(&quot;Stream population for &quot;, &quot;trout&quot;, &quot; &quot;, &quot;species&quot;, &quot; is &quot;, 32, &quot;/mile.&quot;)
u'Stream population for trout species is 32/mile.'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; CONCATENATE(&quot;In &quot;, 4, &quot; days it is &quot;, datetime.date(2016,1,1))
u'In 4 days it is 2016-01-01'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; CONCATENATE(&quot;abc&quot;)
u'abc'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; CONCATENATE(0, &quot;abc&quot;)
u'0abc'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; assert CONCATENATE(2, u&quot; cr√®me &quot;, u&quot;br√ªl√©e&quot;) == u'2 cr√®me br√ªl√©e'

</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; assert CONCATENATE(2,  &quot; cr√®me &quot;, u&quot;br√ªl√©e&quot;) == u'2 cr√®me br√ªl√©e'

</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; assert CONCATENATE(2,  &quot; cr√®me &quot;,  &quot;br√ªl√©e&quot;) == u'2 cr√®me br√ªl√©e'

</code></pre>


</details>
<details id="dollar"><summary >
#### DOLLAR
<code>__DOLLAR__(number, decimals=2)</code>
<a class="headerlink" href="#dollar" title="Permanent link">#</a>
</summary>
Formats a number into a formatted dollar amount, with decimals rounded to the specified place (.
If decimals value is omitted, it defaults to 2.



<pre><code class="language-python">&gt;&gt;&gt; DOLLAR(1234.567)
'$1,234.57'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DOLLAR(1234.567, -2)
'$1,200'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DOLLAR(-1234.567, -2)
'($1,200)'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DOLLAR(-0.123, 4)
'($0.1230)'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DOLLAR(99.888)
'$99.89'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DOLLAR(0)
'$0.00'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; DOLLAR(10, 0)
'$10'
</code></pre>


</details>
<details id="exact"><summary >
#### EXACT
<code>__EXACT__(string1, string2)</code>
<a class="headerlink" href="#exact" title="Permanent link">#</a>
</summary>
Tests whether two strings are identical. Same as `string2 == string2`.



<pre><code class="language-python">&gt;&gt;&gt; EXACT(&quot;word&quot;, &quot;word&quot;)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; EXACT(&quot;Word&quot;, &quot;word&quot;)
False
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; EXACT(&quot;w ord&quot;, &quot;word&quot;)
False
</code></pre>


</details>
<details id="find"><summary >
#### FIND
<code>__FIND__(find_text, within_text, start_num=1)</code>
<a class="headerlink" href="#find" title="Permanent link">#</a>
</summary>
Returns the position at which a string is first found within text.

Find is case-sensitive. The returned position is 1 if within_text starts with find_text.
Start_num specifies the character at which to start the search, defaulting to 1 (the first
character of within_text).

If find_text is not found, or start_num is invalid, raises ValueError.



<pre><code class="language-python">&gt;&gt;&gt; FIND(&quot;M&quot;, &quot;Miriam McGovern&quot;)
1
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FIND(&quot;m&quot;, &quot;Miriam McGovern&quot;)
6
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FIND(&quot;M&quot;, &quot;Miriam McGovern&quot;, 3)
8
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FIND(&quot; #&quot;, &quot;Hello world # Test&quot;)
12
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FIND(&quot;gle&quot;, &quot;Google&quot;, 1)
4
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FIND(&quot;GLE&quot;, &quot;Google&quot;, 1)
Traceback (most recent call last):
...
ValueError: substring not found
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FIND(&quot;page&quot;, &quot;homepage&quot;)
5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FIND(&quot;page&quot;, &quot;homepage&quot;, 6)
Traceback (most recent call last):
...
ValueError: substring not found
</code></pre>


</details>
<details id="fixed"><summary >
#### FIXED
<code>__FIXED__(number, decimals=2, no_commas=False)</code>
<a class="headerlink" href="#fixed" title="Permanent link">#</a>
</summary>
Formats a number with a fixed number of decimal places (2 by default), and commas.
If no_commas is True, then omits the commas.



<pre><code class="language-python">&gt;&gt;&gt; FIXED(1234.567, 1)
'1,234.6'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FIXED(1234.567, -1)
'1,230'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FIXED(-1234.567, -1, True)
'-1230'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FIXED(44.332)
'44.33'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FIXED(3521.478, 2, False)
'3,521.48'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FIXED(-3521.478, 1, True)
'-3521.5'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FIXED(3521.478, 0, True)
'3521'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; FIXED(3521.478, -2, True)
'3500'
</code></pre>


</details>
<details id="left"><summary >
#### LEFT
<code>__LEFT__(string, num_chars=1)</code>
<a class="headerlink" href="#left" title="Permanent link">#</a>
</summary>
Returns a substring of length num_chars from the beginning of the given string. If num_chars is
omitted, it is assumed to be 1. Same as `string[:num_chars]`.



<pre><code class="language-python">&gt;&gt;&gt; LEFT(&quot;Sale Price&quot;, 4)
'Sale'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; LEFT('Swededn')
'S'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; LEFT('Text', -1)
Traceback (most recent call last):
...
ValueError: num_chars invalid
</code></pre>


</details>
<details id="len"><summary >
#### LEN
<code>__LEN__(text)</code>
<a class="headerlink" href="#len" title="Permanent link">#</a>
</summary>
Returns the number of characters in a text string, or the number of items in a list. Same as
[`len`](https://docs.python.org/3/library/functions.html#len) in python.
See [Record Set](#recordset) for an example of using `len` on a list of records.



<pre><code class="language-python">&gt;&gt;&gt; LEN(&quot;Phoenix, AZ&quot;)
11
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; LEN(&quot;&quot;)
0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; LEN(&quot;     One   &quot;)
11
</code></pre>


</details>
<details id="lower"><summary >
#### LOWER
<code>__LOWER__(text)</code>
<a class="headerlink" href="#lower" title="Permanent link">#</a>
</summary>
Converts a specified string to lowercase. Same as `text.lower()`.



<pre><code class="language-python">&gt;&gt;&gt; LOWER(&quot;E. E. Cummings&quot;)
'e. e. cummings'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; LOWER(&quot;Apt. 2B&quot;)
'apt. 2b'
</code></pre>


</details>
<details id="mid"><summary >
#### MID
<code>__MID__(text, start_num, num_chars)</code>
<a class="headerlink" href="#mid" title="Permanent link">#</a>
</summary>
Returns a segment of a string, starting at start_num. The first character in text has
start_num 1.



<pre><code class="language-python">&gt;&gt;&gt; MID(&quot;Fluid Flow&quot;, 1, 5)
'Fluid'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MID(&quot;Fluid Flow&quot;, 7, 20)
'Flow'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MID(&quot;Fluid Flow&quot;, 20, 5)
''
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; MID(&quot;Fluid Flow&quot;, 0, 5)
Traceback (most recent call last):
...
ValueError: start_num invalid
</code></pre>


</details>
<details id="phone_format"><summary >
#### PHONE_FORMAT
<code>__PHONE_FORMAT__(value, country=None, format=None)</code>
<a class="headerlink" href="#phone_format" title="Permanent link">#</a>
</summary>
Formats a phone number.

With no optional arguments, the number must start with "+" and the international dialing prefix,
and will be formatted as an international number, e.g. `+12345678901` becomes `+1 234-567-8901`.

The `country` argument allows specifying a 2-letter country code (e.g. "US" or "GB") for
interpreting phone numbers that don't start with "+". E.g. `PHONE_FORMAT('2025555555', 'US')`
would be seen as a US number and formatted as "(202) 555-5555". Phone numbers that start with
"+" ignore `country`. E.g. `PHONE_FORMAT('+33555555555', 'US')` is a French number because '+33'
is the international prefix for France.

The `format` argument specifies the output format, according to this table:

  - `"#"` or `"NATL"` (default) - use the national format, without the international dialing
    prefix, when possible. E.g. `(234) 567-8901` for "US", or `02 34 56 78 90` for "FR". If
    `country` is omitted, or the number does not correspond to the given country, the
    international format is used instead.
  - `"+"` or `"INTL"` - international format, e.g. `+1 234-567-8901` or
    `+33 2 34 56 78 90`.
  - `"*"` or `"E164"` - E164 format, like international but with no separators, e.g.
    `+12345678901`.
  - `"tel"` or `"RFC3966"` - format suitable to use as a [hyperlink](col-types.md#hyperlinks),
    e.g. 'tel:+1-234-567-8901'.

When specifying the `format` argument, you may omit the `country` argument. I.e.
`PHONE_FORMAT(value, "tel")` is equivalent to `PHONE_FORMAT(value, None, "tel")`.

For more details, see the [phonenumbers](https://github.com/daviddrysdale/python-phonenumbers)
Python library, which underlies this function.



<pre><code class="language-python">&gt;&gt;&gt; PHONE_FORMAT(&quot;+12345678901&quot;)
u'+1 234-567-8901'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; PHONE_FORMAT(&quot;2345678901&quot;, &quot;US&quot;)
u'(234) 567-8901'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; PHONE_FORMAT(&quot;2345678901&quot;, &quot;GB&quot;)
u'023 4567 8901'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; PHONE_FORMAT(&quot;2345678901&quot;, &quot;GB&quot;, &quot;+&quot;)
u'+44 23 4567 8901'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; PHONE_FORMAT(&quot;+442345678901&quot;, &quot;GB&quot;)
u'023 4567 8901'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; PHONE_FORMAT(&quot;+12345678901&quot;, &quot;GB&quot;)
u'+1 234-567-8901'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; PHONE_FORMAT(&quot;(234) 567-8901&quot;)
Traceback (most recent call last):
...
NumberParseException: (0) Missing or invalid default region.
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; PHONE_FORMAT(&quot;(234)567 89-01&quot;, &quot;US&quot;, &quot;tel&quot;)
u'tel:+1-234-567-8901'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; PHONE_FORMAT(&quot;2/3456/7890&quot;, &quot;FR&quot;, '#')
u'02 34 56 78 90'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; PHONE_FORMAT(&quot;+33234567890&quot;, '#')
u'+33 2 34 56 78 90'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; PHONE_FORMAT(&quot;+33234567890&quot;, 'tel')
u'tel:+33-2-34-56-78-90'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; PHONE_FORMAT(&quot;tel:+1-234-567-8901&quot;, country=&quot;US&quot;, format=&quot;*&quot;)
u'+12345678901'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; PHONE_FORMAT(33234567890)
Traceback (most recent call last):
...
TypeError: Phone number must be a text value. If formatting a value from a Numeric column, convert that column to Text first.
</code></pre>


</details>
<details id="proper"><summary >
#### PROPER
<code>__PROPER__(text)</code>
<a class="headerlink" href="#proper" title="Permanent link">#</a>
</summary>
Capitalizes each word in a specified string. It converts the first letter of each word to
uppercase, and all other letters to lowercase. Same as `text.title()`.



<pre><code class="language-python">&gt;&gt;&gt; PROPER('this is a TITLE')
'This Is A Title'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; PROPER('2-way street')
'2-Way Street'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; PROPER('76BudGet')
'76Budget'
</code></pre>


</details>
<details id="regexextract"><summary >
#### REGEXEXTRACT
<code>__REGEXEXTRACT__(text, regular_expression)</code>
<a class="headerlink" href="#regexextract" title="Permanent link">#</a>
</summary>
Extracts the first part of text that matches regular_expression.



<pre><code class="language-python">&gt;&gt;&gt; REGEXEXTRACT(&quot;Google Doc 101&quot;, &quot;[0-9]+&quot;)
'101'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; REGEXEXTRACT(&quot;The price today is $826.25&quot;, &quot;[0-9]*\.[0-9]+[0-9]+&quot;)
'826.25'
</code></pre>


If there is a parenthesized expression, it is returned instead of the whole match.


<pre><code class="language-python">&gt;&gt;&gt; REGEXEXTRACT(&quot;(Content) between brackets&quot;, &quot;\(([A-Za-z]+)\)&quot;)
'Content'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; REGEXEXTRACT(&quot;Foo&quot;, &quot;Bar&quot;)
Traceback (most recent call last):
...
ValueError: REGEXEXTRACT text does not match
</code></pre>


</details>
<details id="regexmatch"><summary >
#### REGEXMATCH
<code>__REGEXMATCH__(text, regular_expression)</code>
<a class="headerlink" href="#regexmatch" title="Permanent link">#</a>
</summary>
Returns whether a piece of text matches a regular expression.



<pre><code class="language-python">&gt;&gt;&gt; REGEXMATCH(&quot;Google Doc 101&quot;, &quot;[0-9]+&quot;)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; REGEXMATCH(&quot;Google Doc&quot;, &quot;[0-9]+&quot;)
False
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; REGEXMATCH(&quot;The price today is $826.25&quot;, &quot;[0-9]*\.[0-9]+[0-9]+&quot;)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; REGEXMATCH(&quot;(Content) between brackets&quot;, &quot;\(([A-Za-z]+)\)&quot;)
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; REGEXMATCH(&quot;Foo&quot;, &quot;Bar&quot;)
False
</code></pre>


</details>
<details id="regexreplace"><summary >
#### REGEXREPLACE
<code>__REGEXREPLACE__(text, regular_expression, replacement)</code>
<a class="headerlink" href="#regexreplace" title="Permanent link">#</a>
</summary>
Replaces all parts of text matching the given regular expression with replacement text.



<pre><code class="language-python">&gt;&gt;&gt; REGEXREPLACE(&quot;Google Doc 101&quot;, &quot;[0-9]+&quot;, &quot;777&quot;)
'Google Doc 777'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; REGEXREPLACE(&quot;Google Doc&quot;, &quot;[0-9]+&quot;, &quot;777&quot;)
'Google Doc'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; REGEXREPLACE(&quot;The price is $826.25&quot;, &quot;[0-9]*\.[0-9]+[0-9]+&quot;, &quot;315.75&quot;)
'The price is $315.75'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; REGEXREPLACE(&quot;(Content) between brackets&quot;, &quot;\(([A-Za-z]+)\)&quot;, &quot;Word&quot;)
'Word between brackets'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; REGEXREPLACE(&quot;Foo&quot;, &quot;Bar&quot;, &quot;Baz&quot;)
'Foo'
</code></pre>


</details>
<details id="replace"><summary >
#### REPLACE
<code>__REPLACE__(text, position, length, new_text)</code>
<a class="headerlink" href="#replace" title="Permanent link">#</a>
</summary>
Replaces part of a text string with a different text string. Position is counted from 1.



<pre><code class="language-python">&gt;&gt;&gt; REPLACE(&quot;abcdefghijk&quot;, 6, 5, &quot;*&quot;)
'abcde*k'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; REPLACE(&quot;2009&quot;, 3, 2, &quot;10&quot;)
'2010'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; REPLACE('123456', 1, 3, '@')
'@456'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; REPLACE('foo', 1, 0, 'bar')
'barfoo'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; REPLACE('foo', 0, 1, 'bar')
Traceback (most recent call last):
...
ValueError: position invalid
</code></pre>


</details>
<details id="rept"><summary >
#### REPT
<code>__REPT__(text, number_times)</code>
<a class="headerlink" href="#rept" title="Permanent link">#</a>
</summary>
Returns specified text repeated a number of times. Same as `text * number_times`.

The result of the REPT function cannot be longer than 32767 characters, or it raises a
ValueError.



<pre><code class="language-python">&gt;&gt;&gt; REPT(&quot;*-&quot;, 3)
'*-*-*-'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; REPT('-', 10)
'----------'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; REPT('-', 0)
''
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; len(REPT('---', 10000))
30000
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; REPT('---', 11000)
Traceback (most recent call last):
...
ValueError: number_times invalid
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; REPT('-', -1)
Traceback (most recent call last):
...
ValueError: number_times invalid
</code></pre>


</details>
<details id="right"><summary >
#### RIGHT
<code>__RIGHT__(string, num_chars=1)</code>
<a class="headerlink" href="#right" title="Permanent link">#</a>
</summary>
Returns a substring of length num_chars from the end of a specified string. If num_chars is
omitted, it is assumed to be 1. Same as `string[-num_chars:]`.



<pre><code class="language-python">&gt;&gt;&gt; RIGHT(&quot;Sale Price&quot;, 5)
'Price'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; RIGHT('Stock Number')
'r'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; RIGHT('Text', 100)
'Text'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; RIGHT('Text', -1)
Traceback (most recent call last):
...
ValueError: num_chars invalid
</code></pre>


</details>
<details id="search"><summary >
#### SEARCH
<code>__SEARCH__(find_text, within_text, start_num=1)</code>
<a class="headerlink" href="#search" title="Permanent link">#</a>
</summary>
Returns the position at which a string is first found within text, ignoring case.

Find is case-sensitive. The returned position is 1 if within_text starts with find_text.
Start_num specifies the character at which to start the search, defaulting to 1 (the first
character of within_text).

If find_text is not found, or start_num is invalid, raises ValueError.


<pre><code class="language-python">&gt;&gt;&gt; SEARCH(&quot;e&quot;, &quot;Statements&quot;, 6)
7
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SEARCH(&quot;margin&quot;, &quot;Profit Margin&quot;)
8
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SEARCH(&quot; &quot;, &quot;Profit Margin&quot;)
7
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SEARCH('&quot;', 'The &quot;boss&quot; is here.')
5
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SEARCH(&quot;gle&quot;, &quot;Google&quot;)
4
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SEARCH(&quot;GLE&quot;, &quot;Google&quot;)
4
</code></pre>


</details>
<details id="substitute"><summary >
#### SUBSTITUTE
<code>__SUBSTITUTE__(text, old_text, new_text, instance_num=None)</code>
<a class="headerlink" href="#substitute" title="Permanent link">#</a>
</summary>
Replaces existing text with new text in a string. It is useful when you know the substring of
text to replace. Use REPLACE when you know the position of text to replace.

If instance_num is given, it specifies which occurrence of old_text to replace. If omitted, all
occurrences are replaced.

Same as `text.replace(old_text, new_text)` when instance_num is omitted.



<pre><code class="language-python">&gt;&gt;&gt; SUBSTITUTE(&quot;Sales Data&quot;, &quot;Sales&quot;, &quot;Cost&quot;)
u'Cost Data'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SUBSTITUTE(&quot;Quarter 1, 2008&quot;, &quot;1&quot;, &quot;2&quot;, 1)
u'Quarter 2, 2008'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; SUBSTITUTE(&quot;Quarter 1, 2011&quot;, &quot;1&quot;, &quot;2&quot;, 3)
u'Quarter 1, 2012'
</code></pre>

</details>
<details id="t"><summary >
#### T
<code>__T__(value)</code>
<a class="headerlink" href="#t" title="Permanent link">#</a>
</summary>
Returns value if value is text, or the empty string when value is not text.



<pre><code class="language-python">&gt;&gt;&gt; T('Text')
u'Text'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; T(826)
u''
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; T('826')
u'826'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; T(False)
u''
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; T('100 points')
u'100 points'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; T(AltText('Text'))
u'Text'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; T(float('nan'))
u''
</code></pre>


</details>
<details id="tasteme"><summary >
#### TASTEME
<code>__TASTEME__(food)</code>
<a class="headerlink" href="#tasteme" title="Permanent link">#</a>
</summary>
For any given piece of text, decides if it is tasty or not.

This is not serious. It appeared as an Easter egg, and is kept as such. It is in fact a puzzle
to figure out the underlying simple rule. It has been surprisingly rarely cracked, even after
reading the source code, which is freely available and may entertain Python fans.



<pre><code class="language-python">&gt;&gt;&gt; TASTEME('Banana')
True
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; TASTEME('Garlic')
False
</code></pre>


</details>
<details id="text"><summary class="unimplemented">
#### TEXT
<code>__TEXT__(number, format_type)</code>
<a class="headerlink" href="#text" title="Permanent link">#</a>
</summary>
Converts a number into text according to a specified format. It is not yet implemented in
Grist. You can use the similar Python functions str() to convert numbers into strings, and
optionally format() to specify the number format.

<span class="grist-tip">Note</span>This function is not currently implemented in Grist.
</details>
<details id="trim"><summary >
#### TRIM
<code>__TRIM__(text)</code>
<a class="headerlink" href="#trim" title="Permanent link">#</a>
</summary>
Removes all spaces from text except for single spaces between words. Note that TRIM does not
remove other whitespace such as tab or newline characters.



<pre><code class="language-python">&gt;&gt;&gt; TRIM(&quot; First Quarter\n    Earnings     &quot;)
'First Quarter\n Earnings'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; TRIM(&quot;&quot;)
''
</code></pre>


</details>
<details id="upper"><summary >
#### UPPER
<code>__UPPER__(text)</code>
<a class="headerlink" href="#upper" title="Permanent link">#</a>
</summary>
Converts a specified string to uppercase. Same as `text.upper()`.



<pre><code class="language-python">&gt;&gt;&gt; UPPER(&quot;e. e. cummings&quot;)
'E. E. CUMMINGS'
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; UPPER(&quot;Apt. 2B&quot;)
'APT. 2B'
</code></pre>


</details>
<details id="value"><summary >
#### VALUE
<code>__VALUE__(text)</code>
<a class="headerlink" href="#value" title="Permanent link">#</a>
</summary>
Converts a string in accepted date, time or number formats into a number or date.



<pre><code class="language-python">&gt;&gt;&gt; VALUE(&quot;$1,000&quot;)
1000
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; assert VALUE(&quot;16:48:00&quot;) - VALUE(&quot;12:00:00&quot;) == datetime.timedelta(0, 17280)

</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; VALUE(&quot;01/01/2012&quot;)
datetime.datetime(2012, 1, 1, 0, 0)
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; VALUE(&quot;&quot;)
0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; VALUE(0)
0
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; VALUE(&quot;826&quot;)
826
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; VALUE(&quot;-826.123123123&quot;)
-826.123123123
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; VALUE(float('nan'))
nan
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; VALUE(&quot;Invalid&quot;)
Traceback (most recent call last):
...
ValueError: text cannot be parsed to a number
</code></pre>



<pre><code class="language-python">&gt;&gt;&gt; VALUE(&quot;13/13/13&quot;)
Traceback (most recent call last):
...
ValueError: text cannot be parsed to a number
</code></pre>


</details>
<!-- END mkpydocs docs -->

  <br>
</div>

<div class="feedback-box">
  <div class="feedback-box-title">Give Feedback</div>
  <div class="feedback-box-question">Was this article helpful?</div>
  <div class="feedback-box-buttons">
    <button class="feedback-box-button" data-rating="thumbsUp">&#x1F44D;</button>
    <button class="feedback-box-button" data-rating="thumbsDown">&#x1F44E;</button>
  </div>
  <div class="feedback-box-response">
    Thank you for letting us know!
  </div>
</div>

<script>
function initFeedbackButtons() {
  const serverUrl = "https://docs.getgrist.com";
  const feedbackBox = document.querySelector('.feedback-box');
  const buttons = document.querySelectorAll('.feedback-box-button');
  document.querySelector('.feedback-box-buttons').addEventListener('click', giveFeedback);

  async function giveFeedback(event) {
    const rating = event.target.dataset.rating;
    if (!rating) { return; }
    buttons.forEach(b => { b.disabled = true; });
    try {
      console.log("Sending rating to " + serverUrl + '/api/telemetry');
      const resp = await window.fetch(serverUrl + '/api/telemetry', makePayload(rating));
      if (!resp.ok) { throw new Error(resp.statusText); }
    } catch (err) {
      console.warn('Failed to report feedback', err);
      document.querySelector('.feedback-box-response').textContent = String(err);
    } finally {
      buttons.forEach(b => { b.disabled = false; });
      feedbackBox.classList.add('feedback-submitted');
    }
  }

  function makePayload(rating) {
    const url = window.location.href;
    return {
      method: 'POST',
      body: JSON.stringify({
        event: 'ratedHelpCenterArticle',
        metadata: {full: {url, rating}},
      }),
      credentials: 'same-origin',
      headers: {
        'Content-Type': 'application/json',
        'X-Requested-With': 'XMLHttpRequest',
      },
    };
  }
}
initFeedbackButtons();
</script><footer class="col-md-12 wm-page-content">
      <p>
        <a href="https://github.com/gristlabs/grist-help/edit/master/docs/functions.md"><i class="fa fa-github"></i>
Edit on GitHub</a>
      </p>
  <p>Documentation built with <a href="http://www.mkdocs.org/">MkDocs</a> using <a href="https://github.com/gristlabs/mkdocs-windmill">Windmill</a> theme by Grist Labs.</p>
</footer>

    </div>
  </div>
</div>

<div class="modal fade" id="video-modal" tabindex="-1" role="dialog" aria-labelledby="video-modal" aria-hidden="true">
  <div class="modal-dialog modal-lg">
    <div class="modal-content">
      <div class="modal-body">
        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        <div style="position:relative; padding-bottom:56.25%; margin-top: 32px;">
          <iframe src="" allowfullscreen style="position:absolute; left:0; top:0; width:100%; height:100%"></iframe>
        </div>
      </div>
    </div>
  </div>
</div>

</body>
</html>